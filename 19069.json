{"post_stream":{"posts":[{"id":75647,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2020-07-24T12:29:52.814Z","cooked":"\u003cp\u003eA hook is an executable file that runs within a snap’s confined environment when a specific action occurs.\u003c/p\u003e\n\u003cp\u003eThe filename of the executable is based on the name of the hook. If this file exists,  \u003cem\u003esnapd\u003c/em\u003e  will execute the file when required by that hook’s action. See \u003ca href=\"/t/supported-snap-hooks/3795\"\u003eSupported snap hooks\u003c/a\u003e for more details on which hooks are supported.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"/t/snapcraft-overview/8940\"\u003eSnapcraft\u003c/a\u003e can integrate hooks into a snap using two methods:\u003c/p\u003e\n\u003ch3\u003e1. Using a project-wide \u003ccode\u003esnap/hooks\u003c/code\u003e directory\u003c/h3\u003e\n\u003cp\u003eThe hook executable can be placed in a directory called \u003ccode\u003esnap/hooks\u003c/code\u003e relative to where the \u003ccode\u003esnapcraft\u003c/code\u003e command is executed. This will typically mean creating a \u003cem\u003ehooks\u003c/em\u003e directory in the same directory that contains the \u003cem\u003esnapcraft.yaml\u003c/em\u003e file for your project. The following, for example, shows the location of a configure hook executable:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e.\n└── snap\n    ├── hooks\n    │   └── configure\n    └── snapcraft.yaml\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHook executables in \u003ccode\u003esnap/hooks\u003c/code\u003e are automatically copied into the snap during Snapcraft’s \u003ccode\u003eprime\u003c/code\u003e step (see \u003ca href=\"/t/parts-lifecycle/12230\"\u003eParts lifecycle\u003c/a\u003e for details).\u003c/p\u003e\n\u003ch3\u003e2. From within snapcraft.yaml\u003c/h3\u003e\n\u003cp\u003eA part within \u003ca href=\"/t/the-snapcraft-format/8337\"\u003esnapcraft.yaml\u003c/a\u003e can also generate and install hook executables into \u003ccode\u003e$SNAPCRAFT_PART_INSTALL/snap/hooks/\u003c/code\u003e. These are automatically copied into the snap during the \u003ccode\u003eprime\u003c/code\u003e step.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-yaml\"\u003econfigure-hook:\n    plugin: dump\n    source: configure-again/\n    organize:\n        configure: snap/hooks/configure\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003ePlugs\u003c/h2\u003e\n\u003cp\u003eBy default, hooks run with no plugs. If a hook needs more privileges, it can use the top-level \u003ccode\u003ehooks\u003c/code\u003e attribute in \u003ccode\u003esnapcraft.yaml\u003c/code\u003e to request plugs:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-yaml\"\u003ehooks: # Top-level YAML attribute, parallel to `apps`\n  configure: # Hook name, corresponds to executable name\n    plugs: [network] # Or any other plugs required by this hook\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHooks are called with no parameters. See \u003ca href=\"/t/using-the-snapctl-tool/15002\"\u003eUsing the snapctl tool\u003c/a\u003e for details on the internal command they can use to provide and retrieve data to and from snapd.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2022-02-03T18:17:16.703Z","reply_count":4,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":198,"reads":40,"readers_count":39,"score":1033.0,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":3,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://forum.snapcraft.io/t/supported-snap-hooks/3795","internal":true,"reflection":false,"title":"Supported snap hooks","clicks":14},{"url":"https://forum.snapcraft.io/t/using-the-snapctl-tool/15002","internal":true,"reflection":false,"title":"Using the snapctl tool","clicks":6},{"url":"https://forum.snapcraft.io/t/snapcraft-overview/8940","internal":true,"reflection":false,"title":"Snapcraft overview","clicks":3},{"url":"https://forum.snapcraft.io/t/the-snapcraft-format/8337","internal":true,"reflection":false,"title":"The snapcraft.yaml schema","clicks":1},{"url":"https://forum.snapcraft.io/t/snap-documentation/11127","internal":true,"reflection":true,"title":"Snap documentation","clicks":0},{"url":"https://forum.snapcraft.io/t/snapcraft-top-level-metadata/8334","internal":true,"reflection":true,"title":"Snapcraft top-level metadata","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":true,"last_wiki_edit":"2022-02-03T18:17:16.722Z","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":98298,"name":"Fabio Colella","username":"fcole90","avatar_template":"/user_avatar/forum.snapcraft.io/fcole90/{size}/6214_2.png","created_at":"2021-08-27T15:25:13.687Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"degville\" data-post=\"1\" data-topic=\"19069\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/degville/40/2021_2.png\" class=\"avatar\"\u003e degville:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHooks that are generated from a part will include that part’s environment. Using the previous Python part example, this means \u003ccode\u003e$PYTHONPATH\u003c/code\u003e will be defined and accessible by the hook.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eThe code example at 2 doesn’t seem to have any Python plugin \u003cimg src=\"https://forum.snapcraft.io/images/emoji/emoji_one/thinking.png?v=9\" title=\":thinking:\" class=\"emoji\" alt=\":thinking:\"\u003e Does it mean I just need to add something like\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-yaml\"\u003eorganize:\n        configure: snap/hooks/configure\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eto whatever part (regardless of the plugin) to have my hooks in the right place and aware of my binaries? \u003cimg src=\"https://forum.snapcraft.io/images/emoji/emoji_one/blush.png?v=9\" title=\":blush:\" class=\"emoji\" alt=\":blush:\"\u003e\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2021-08-27T15:25:13.687Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":0,"reads":25,"readers_count":24,"score":5.0,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Fabio Colella","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":335,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":98299,"name":"Fabio Colella","username":"fcole90","avatar_template":"/user_avatar/forum.snapcraft.io/fcole90/{size}/6214_2.png","created_at":"2021-08-27T15:26:34.789Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"degville\" data-post=\"1\" data-topic=\"19069\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/degville/40/2021_2.png\" class=\"avatar\"\u003e degville:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHooks copied from \u003ccode\u003esnap/hooks\u003c/code\u003e cannot access, nor be affected by, a part’s environment. For example, if a snap includes a Python part, \u003ccode\u003e$PYTHONPATH\u003c/code\u003e will \u003cem\u003enot\u003c/em\u003e be defined and accessible from the hook.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eRegardless of env variables, can I access and run my binaries or do I need a part-specific hook?\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2021-08-27T15:26:34.789Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":1,"reads":24,"readers_count":23,"score":9.8,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Fabio Colella","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":335,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":105044,"name":"Robert P. J. Day","username":"rpjday","avatar_template":"/user_avatar/forum.snapcraft.io/rpjday/{size}/8457_2.png","created_at":"2022-01-31T09:55:36.852Z","cooked":"\u003cp\u003eI’m curious about Step 2 above, which clearly copies the configure hook script from the source location configure-again/. But if you already have the hook source available to you, why not just use Technique 1 and put it in snap/hooks to begin with? I’m having trouble seeing the value of Technique 2 here.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2022-01-31T09:55:36.852Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":22,"readers_count":21,"score":19.4,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Robert P. J. Day","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":11710,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":105105,"name":"林博仁(Buo-ren, Lin)","username":"Lin-Buo-Ren","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png","created_at":"2022-02-01T17:28:53.769Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"degville\" data-post=\"1\" data-topic=\"19069\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/degville/40/2021_2.png\" class=\"avatar\"\u003e degville:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHooks copied from \u003ccode\u003esnap/hooks\u003c/code\u003e cannot access, nor be affected by, a part’s environment. For example, if a snap includes a Python part, \u003ccode\u003e$PYTHONPATH\u003c/code\u003e will \u003cem\u003enot\u003c/em\u003e be defined and accessible from the hook.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003caside class=\"quote no-group\" data-username=\"degville\" data-post=\"1\" data-topic=\"19069\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/degville/40/2021_2.png\" class=\"avatar\"\u003e degville:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHooks that are generated from a part will include that part’s environment. Using the previous Python part example, this means \u003ccode\u003e$PYTHONPATH\u003c/code\u003e will be defined and accessible by the hook.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eI wonder whether the passages above are valid?  Is “the part’s environment” mean the \u003ccode\u003ebuild-environment\u003c/code\u003e defined in the providing part’s definition, or the environment applied by the plugin building these parts(like \u003ccode\u003epython\u003c/code\u003e)?\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2022-02-01T17:30:50.369Z","reply_count":1,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":1,"reads":19,"readers_count":18,"score":13.8,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"林博仁(Buo-ren, Lin)","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1417,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":105110,"name":"林博仁(Buo-ren, Lin)","username":"Lin-Buo-Ren","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png","created_at":"2022-02-01T17:47:08.675Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"Lin-Buo-Ren\" data-post=\"5\" data-topic=\"19069\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/lin-buo-ren/40/4612_2.png\" class=\"avatar\"\u003e Lin-Buo-Ren:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eor the environment applied by the plugin building these parts(like \u003ccode\u003epython\u003c/code\u003e)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eI unable to find \u003ccode\u003ePYTHONPATH\u003c/code\u003e or similar environment variables in \u003ca href=\"https://github.com/snapcore/snapcraft/blob/main/snapcraft/plugins/v2/python.py\"\u003ethe \u003ccode\u003epython\u003c/code\u003e plugin’s source code\u003c/a\u003e.\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2022-02-01T17:47:08.675Z","reply_count":1,"reply_to_post_number":5,"quote_count":1,"incoming_link_count":0,"reads":19,"readers_count":18,"score":8.8,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"林博仁(Buo-ren, Lin)","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/snapcore/snapcraft/blob/main/snapcraft/plugins/v2/python.py","internal":false,"reflection":false,"clicks":0}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1417,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":105244,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2022-02-04T10:35:06.857Z","cooked":"\u003cp\u003eI’ve tweaked this page slightly after experimenting with environment scope - I agree that the build environment is only going to be relevant during the build for that part  (which may be used to inform the values used to create a hook script, I’m guessing) but not when the hook is eventually executed. I edited option two slightly to suggest a part can generate its own hooks, rather than simply dump them from outside.\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2022-02-04T10:35:06.857Z","reply_count":1,"reply_to_post_number":6,"quote_count":0,"incoming_link_count":1,"reads":18,"readers_count":17,"score":13.6,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"Lin-Buo-Ren","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png"},"bookmarked":false,"actions_summary":[],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":105255,"name":"Robert P. J. Day","username":"rpjday","avatar_template":"/user_avatar/forum.snapcraft.io/rpjday/{size}/8457_2.png","created_at":"2022-02-04T12:30:43.428Z","cooked":"\u003cp\u003eSo, to be clear, the only real reason to use Technique 2 is if you, in some way, needed to \u003cem\u003edynamically\u003c/em\u003e generate the contents of the hook script during snapcraft run time.\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2022-02-04T12:30:43.428Z","reply_count":1,"reply_to_post_number":7,"quote_count":0,"incoming_link_count":0,"reads":16,"readers_count":15,"score":8.2,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Robert P. J. Day","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","reply_to_user":{"username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":11710,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":105259,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2022-02-04T12:53:16.562Z","cooked":"\u003cp\u003eI think it also helps if hooks aren’t (or can’t be) sourced from \u003ccode\u003esnap/hooks\u003c/code\u003e, for whatever reason.\u003c/p\u003e","post_number":9,"post_type":1,"updated_at":"2022-02-04T12:53:16.562Z","reply_count":0,"reply_to_post_number":8,"quote_count":0,"incoming_link_count":0,"reads":18,"readers_count":17,"score":3.6,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"rpjday","avatar_template":"/user_avatar/forum.snapcraft.io/rpjday/{size}/8457_2.png"},"bookmarked":false,"actions_summary":[],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":124075,"name":"Nate","username":"n8marti","avatar_template":"/user_avatar/forum.snapcraft.io/n8marti/{size}/8318_2.png","created_at":"2023-05-25T14:37:51.352Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"degville\" data-post=\"1\" data-topic=\"19069\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/degville/40/2021_2.png\" class=\"avatar\"\u003e degville:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eA hook is an executable file that runs within a snap’s confined environment\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eIs there documentation on this that I haven’t found yet? I’ve just figured out that the “user” in $SNAP_USER_COMMON during the pre-refresh hook is root rather than the installed snap user. I’d like to know more about what all the environment variables are during hooks so I can accomplish my goal of backup up certain files in $SNAP_USER_COMMON of the installed snap before a refresh.\u003c/p\u003e","post_number":10,"post_type":1,"updated_at":"2023-05-25T14:37:51.352Z","reply_count":1,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":0,"reads":5,"readers_count":4,"score":5.8,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Nate","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1596,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":124079,"name":"Nate","username":"n8marti","avatar_template":"/user_avatar/forum.snapcraft.io/n8marti/{size}/8318_2.png","created_at":"2023-05-25T16:03:00.099Z","cooked":"\u003cp\u003eAfter reading through a few more posts I’ve decided to make user-specific tasks happen as part of the snap’s own execution rather than through a root-level hook. That seems to be the more appropriate solution.\u003c/p\u003e\n\u003cp\u003eIt would still be helpful to explicitly say in the docs that the snap hooks run as root user. It’s obvious now in hindsight, but it wasn’t to me in the beginning. Maybe snap could also consider user-level hooks? Somehow the system knows about specific users when making snapshots, so maybe that knowledge could be leveraged for hooks, too?\u003c/p\u003e","post_number":11,"post_type":1,"updated_at":"2023-05-25T16:03:00.099Z","reply_count":1,"reply_to_post_number":10,"quote_count":0,"incoming_link_count":0,"reads":4,"readers_count":3,"score":5.6,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Nate","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","reply_to_user":{"username":"n8marti","avatar_template":"/user_avatar/forum.snapcraft.io/n8marti/{size}/8318_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1596,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":124081,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2023-05-25T16:32:02.922Z","cooked":"\u003cp\u003eHi! Thanks for commenting on this. You’re right that we don’t make it clear hooks are running as root (through snapd, which is always running as root). I’ll add something to explain it better.\u003c/p\u003e\n\u003cp\u003eI could also tie this closer to our environment variables document, especially \u003ca href=\"https://forum.snapcraft.io/t/environment-variables/7983#heading--snap-user-common\"\u003eSNAP_USER_COMMON\u003c/a\u003e which as you’ve found is within a user’s home directory.\u003c/p\u003e","post_number":12,"post_type":1,"updated_at":"2023-05-25T16:32:02.922Z","reply_count":0,"reply_to_post_number":11,"quote_count":0,"incoming_link_count":0,"reads":4,"readers_count":3,"score":0.6,"yours":false,"topic_id":19069,"topic_slug":"snapcraft-hook-support","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://forum.snapcraft.io/t/environment-variables/7983","internal":true,"reflection":false,"title":"Environment variables","clicks":0}],"read":true,"user_title":null,"reply_to_user":{"username":"n8marti","avatar_template":"/user_avatar/forum.snapcraft.io/n8marti/{size}/8318_2.png"},"bookmarked":false,"actions_summary":[],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[75647,98298,98299,105044,105105,105110,105244,105255,105259,124075,124079,124081]},"timeline_lookup":[[1,1057],[2,657],[4,501],[5,499],[7,497],[10,21]],"suggested_topics":[{"id":33076,"title":"Intermediate snapcraft.yaml example","fancy_title":"Intermediate snapcraft.yaml example","slug":"intermediate-snapcraft-yaml-example","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2022-12-13T12:33:36.674Z","last_posted_at":"2022-12-15T10:46:41.984Z","bumped":true,"bumped_at":"2022-12-13T12:33:36.830Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":813,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":33074,"title":"Basic snapcraft.yaml example","fancy_title":"Basic snapcraft.yaml example","slug":"basic-snapcraft-yaml-example","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2022-12-13T10:53:46.449Z","last_posted_at":"2022-12-15T10:45:49.975Z","bumped":true,"bumped_at":"2022-12-13T10:53:46.598Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":887,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":35613,"title":"Revisions","fancy_title":"Revisions","slug":"revisions","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2023-06-14T12:00:32.246Z","last_posted_at":"2023-06-14T12:00:32.397Z","bumped":true,"bumped_at":"2023-06-15T11:10:36.858Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":44,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":32986,"title":"Snapcraft installation and setup","fancy_title":"Snapcraft installation and setup","slug":"snapcraft-installation-and-setup","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2022-12-07T12:49:10.746Z","last_posted_at":"2022-12-15T10:43:52.370Z","bumped":true,"bumped_at":"2022-12-07T12:49:10.898Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":819,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":34416,"title":"How to guides for classic confinement","fancy_title":"How to guides for classic confinement","slug":"how-to-guides-for-classic-confinement","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2023-03-21T09:34:37.128Z","last_posted_at":"2023-03-21T09:50:37.844Z","bumped":true,"bumped_at":"2023-03-21T09:50:37.844Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":["how-to"],"like_count":0,"views":461,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":14015,"username":"dboddie","name":"David Boddie","avatar_template":"/user_avatar/forum.snapcraft.io/dboddie/{size}/9564_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]}],"tags":[],"id":19069,"title":"Snapcraft hook support","fancy_title":"Snapcraft hook support","posts_count":12,"created_at":"2020-07-24T12:29:52.667Z","views":3893,"reply_count":6,"like_count":2,"last_posted_at":"2023-05-25T16:32:02.922Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"snapcraft-hook-support","category_id":15,"word_count":1069,"deleted_at":null,"user_id":2772,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_19069","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":12,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"topic_timer":null,"message_bus_last_id":0,"participant_count":5,"show_read_indicator":false,"thumbnails":null,"details":{"notification_level":1,"participants":[{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","post_count":4,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":335,"username":"fcole90","name":"Fabio Colella","avatar_template":"/user_avatar/forum.snapcraft.io/fcole90/{size}/6214_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1417,"username":"Lin-Buo-Ren","name":"林博仁(Buo-ren, Lin)","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1596,"username":"n8marti","name":"Nate","avatar_template":"/user_avatar/forum.snapcraft.io/n8marti/{size}/8318_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":11710,"username":"rpjday","name":"Robert P. J. Day","avatar_template":"/user_avatar/forum.snapcraft.io/rpjday/{size}/8457_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null}],"created_by":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"},"last_poster":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"},"links":[{"url":"https://forum.snapcraft.io/t/supported-snap-hooks/3795","title":"Supported snap hooks","internal":true,"attachment":false,"reflection":false,"clicks":14,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/using-the-snapctl-tool/15002","title":"Using the snapctl tool","internal":true,"attachment":false,"reflection":false,"clicks":6,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/snapcraft-overview/8940","title":"Snapcraft overview","internal":true,"attachment":false,"reflection":false,"clicks":3,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/the-snapcraft-format/8337","title":"The snapcraft.yaml schema","internal":true,"attachment":false,"reflection":false,"clicks":1,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"}]}}