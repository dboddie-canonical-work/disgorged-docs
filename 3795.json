{"post_stream":{"posts":[{"id":18770,"name":"Wiki Content","username":"wiki","avatar_template":"/user_avatar/forum.snapcraft.io/wiki/{size}/425_2.png","created_at":"2018-01-31T20:20:44.251Z","cooked":"\u003cp\u003eA hook is an executable file that runs within a snap’s confined environment when a certain action occurs.\u003c/p\u003e\n\u003cp\u003eCommon examples of actions requiring hooks include:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003enotifying a snap that something has happened\u003c/strong\u003e\u003cbr\u003e\nExample: If a snap has been upgraded, the snap may need to trigger a scripted migration process to port an old data format to the new one.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003enotifying a snap that a specific operation is in progress\u003c/strong\u003e\u003cbr\u003e\nExample: A snap may need to know when a specific interface connects or disconnects.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eA hook is defined as an executable within a snap’s \u003ccode\u003emeta/hooks/\u003c/code\u003e directory, and consequently, also within \u003ccode\u003esnap/hooks/\u003c/code\u003e when building with \u003cem\u003esnapcraft\u003c/em\u003e. See \u003ca href=\"/t/snapcraft-hook-support/19069\"\u003eSnapcraft hook support\u003c/a\u003e for more information.\u003c/p\u003e\n\u003cp\u003eThe filename of the executable is based on the name of the hook. If this file exists, \u003cem\u003esnapd\u003c/em\u003e will execute the file when required by that hook’s action.\u003c/p\u003e\n\u003cp\u003eThe following hooks are currently implemented:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#heading--the-configure-hook\"\u003econfigure hook\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--default-configure\"\u003edefault-configure hook\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--fde\"\u003efull-disk-encryption hook\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--gate-auto-refresh\"\u003egate-auto-refresh\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--install\"\u003einstall hook\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--install-device\"\u003einstall-device hook\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--interface\"\u003einterface hooks\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--prepare-device\"\u003eprepare-device hook\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--pre-refresh\"\u003epre-refresh hook\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--post-refresh\"\u003epost-refresh hook\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heading--remove\"\u003eremove hook\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eⓘ \u003cstrong\u003eDefault shell environment\u003c/strong\u003e: A hook script can only assume a POSIX-compliant shell environment for its execution. If your script needs a specific shell, such as \u003cem\u003eBash\u003c/em\u003e or \u003cem\u003eZsh\u003c/em\u003e, it needs to be explicitly declared within the script’s \u003cem\u003ehashbang\u003c/em\u003e header (\u003ccode\u003e#!/bin/bash\u003c/code\u003e, for example). Your snap also needs to ensure your chosen shell is available.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003eAccessing resources\u003c/h2\u003e\n\u003cp\u003eIf a hook requires access to system resources outside of a snap’s confined environment, it will need to use \u003ca href=\"/t/interface-management/6154#slots-plugs\"\u003eslots and plugs\u003c/a\u003e via the \u003ca href=\"/t/interface-management/6154\"\u003einterface\u003c/a\u003e mechanism to access those resources.\u003c/p\u003e\n\u003cp\u003eWhen using \u003cem\u003eSnapcraft\u003c/em\u003e to build the snap, the interface definition will go inside \u003ca href=\"/t/the-snapcraft-format/8337\"\u003esnapcraft.yaml\u003c/a\u003e, and the \u003cem\u003esnapcraft\u003c/em\u003e command create a \u003ca href=\"/t/the-snap-format/698\"\u003esnap.yaml\u003c/a\u003e within the snap to hold the required metadata.\u003c/p\u003e\n\u003cp\u003eFor example, the following excerpt registers an \u003cem\u003einstall\u003c/em\u003e hook making use of a \u003ca href=\"/t/the-network-interface/7880\"\u003enetwork\u003c/a\u003e plug:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-yaml\"\u003eapps:\n    ...\n\nhooks:\n    install:\n        plugs: [network]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHooks are called with no parameters. When a hook needs to request or modify information within \u003cem\u003esnapd\u003c/em\u003e,  they can do so via the \u003cem\u003esnapctl\u003c/em\u003e tool, which is always available within a snap’s environment. See \u003ca href=\"/t/using-the-snapctl-tool/15002\"\u003eUsing the snapctl tool\u003c/a\u003e for further details.\u003c/p\u003e\n\u003cp\u003eA hook is executed as a single transaction, where a transaction object holds all the configuration changes for that hook. These changes are invisible to the running system until the hook completely finishes. This allows for changes to be rolled back or \u003cem\u003eunset\u003c/em\u003e if errors occur during the execution of a hook.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"heading--the-configure-hook\"\u003eThe configure hook\u003csup\u003e\u003ca href=\"#heading--the-configure-hook\"\u003e⚓\u003c/a\u003e\u003c/sup\u003e\n\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003econfigure\u003c/code\u003e hook is called every time one the following actions happen:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003einitial snap installation\u003c/li\u003e\n\u003cli\u003esnap refresh\u003c/li\u003e\n\u003cli\u003ewhenever the user runs \u003ccode\u003esnap set|unset\u003c/code\u003e to change a configuration option\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eⓘ Note that this hook will \u003cem\u003enot\u003c/em\u003e get called when the snap \u003cem\u003eitself\u003c/em\u003e changes configuration options using \u003ccode\u003esnapctl get|set|unset\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThe hook should use \u003ccode\u003esnapctl get\u003c/code\u003e to retrieve configuration values from snapd. If the hook exits with a non-zero status code, the configuration will not be applied.\u003c/p\u003e\n\u003cp\u003eFor example, given the following command:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-bash\"\u003e$ snap set mysnap username=foo password=bar\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe \u003ccode\u003econfigure\u003c/code\u003e hook located within the \u003cem\u003emysnap\u003c/em\u003e snap at \u003ccode\u003emeta/hooks/configure\u003c/code\u003e would be called to apply the configuration changes, if necessary.\u003c/p\u003e\n\u003cp\u003eThe hook might look similar to:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e#!/bin/sh -e\n\nusername=\"$(snapctl get username)\"\npassword=\"$(snapctl get password)\"\n\nif [ -z \"$username\" -o -z \"$password\" ]; then\n    echo \"Username and password are required.\"\n    exit 1\nfi\n\nmkdir -m 0600 $SNAP_DATA/options\necho \"username: $username\" \u0026gt; $SNAP_DATA/options/credentials\necho \"password: $password\" \u0026gt;\u0026gt; $SNAP_DATA/options/credentials\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe same hook can also modify the configuration of a snap within the context of the current transaction. This is accomplished using \u003ccode\u003esnapctl set\u003c/code\u003e and \u003ccode\u003esnapctl unset\u003c/code\u003e. For more information see \u003ca href=\"/t/adding-snap-configuration/15246\"\u003eAdding Snap configuration\u003c/a\u003e and \u003ca href=\"/t/using-the-snapctl-tool/15002\"\u003eUsing the snapctl tool\u003c/a\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eⓘ Note that configuration options do not need to be defined anywhere. \u003ccode\u003esnapctl set\u003c/code\u003e and \u003ccode\u003esnap set\u003c/code\u003e will accept any (valid) option name.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"heading--default-configure\"\u003eThe default-configure hook\u003c/h2\u003e\n\u003cp\u003eThe default-configure-hook is an optional extension to the \u003ca href=\"/t/supported-snap-hooks/3795#heading--the-configure-hook\"\u003econfigure hook\u003c/a\u003e that executes only on snap installation and \u003cem\u003ebefore\u003c/em\u003e services are started to provide access to the default configuration values stored in a device’s \u003ca href=\"/t/gadget-snaps/696\"\u003egadget snap\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe default-configure hook should be located within ‘meta/hooks’ and requires a configure hook to be present. A missing configure hook will result in an error.\u003c/p\u003e\n\u003cp\u003eThe hook should use \u003ccode\u003esnapctl get\u003c/code\u003e to retrieve default configuration options and \u003ccode\u003esnapctl set\u003c/code\u003e and \u003ccode\u003esnapctl unset\u003c/code\u003e to create/modify options. If the hook exits with a non-zero status code, the default configuration provided by the gadget snap as well as modifications by the hook will not be applied.\u003c/p\u003e\n\u003cp\u003eExample default-configure hook:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e#!/bin/sh -e\n\nDEFAULT_GADGET_OPTION=”123”\n\ngadget_option=\"$(snapctl get gadget_option)\"\nif [ -z \"$gadget_option\" ]; then\ngadget_option=\"$DEFAULT_GADGET_OPTION\"\nfi\n\nmkdir -m 0600 $SNAP_DATA/options\necho \"option: $gadget_option\" \u0026gt; $SNAP_DATA/options/gadget\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFor more information see \u003ca href=\"/t/adding-snap-configuration/15246\"\u003eAdding Snap configuration\u003c/a\u003e and \u003ca href=\"/t/using-the-snapctl-tool/15002\"\u003eUsing the snapctl tool\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"heading--fde\"\u003eThe full-disk-encryption hook\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://ubuntu.com/core/docs/uc20/\" rel=\"noopener nofollow ugc\"\u003eUbuntu Core 20 \u003c/a\u003e (UC20) uses \u003ca href=\"https://ubuntu.com/core/docs/uc20/full-disk-encryption\" rel=\"noopener nofollow ugc\"\u003efull disk encryption\u003c/a\u003e (FDE) whenever the hardware allows, protecting both the confidentiality and integrity of a device’s data when there’s physical access to a device, or after a device has been lost or stolen.\u003c/p\u003e\n\u003cp\u003eCreating a verifiable boot process on a non-standard (non-UEFI+TPM platform) FDE platform, such as a Raspberry Pi or other ARM devices, is board-specific and will typically involve creating custom gadget and kernel snaps. UC20, however, does provide a helper mechanism, via a hook interface, to ensure the integrity of any subsequently executed or accessed data.\u003c/p\u003e\n\u003cp\u003eSee \u003ca href=\"/t/uc20-full-disk-encryption-hook-interface/24439\"\u003eUC20 full-disk-encryption hook interface\u003c/a\u003e for details on how this hook is implemented.\u003c/p\u003e\n\u003ch2 id=\"heading--gate-auto-refresh\"\u003eThe gate-auto-refresh hook\u003c/h2\u003e\n\u003cp\u003eThe gate-auto-refresh hook is executed by snapd for every snap that will be updated with the next automatic refresh. It’s also executed for every snap that is dependent on a snap that will be updated.\u003c/p\u003e\n\u003cp\u003eThis hook is capable of executing the snapctl refresh command with 3 specific arguments, hold, proceed and pending.\u003c/p\u003e\n\u003cp\u003eThis feature is currently considered experimental. See \u003ca href=\"/t/refresh-control/27213\"\u003eRefresh control\u003c/a\u003e for more details.\u003c/p\u003e\n\u003ch2 id=\"heading--install\"\u003eThe install hook\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003einstall\u003c/code\u003e hook is called upon initial install only, i.e. it’s not called on subsequent refreshes.\u003c/p\u003e\n\u003cp\u003eThe hook is executed before starting snap services (if it has any) and before the \u003ccode\u003econfigure\u003c/code\u003e hook. The install hook is the place for one-time actions, such as an early initialisation of a resource when installed for the first time.\u003c/p\u003e\n\u003ch2 id=\"heading--install-device\"\u003eThe install-device hook\u003c/h2\u003e\n\u003cp\u003eThis hook is supported in Ubuntu Core 20 and subsequent releases.\u003c/p\u003e\n\u003cp\u003eSee \u003ca href=\"https://ubuntu.com/core/docs/uc20/installation-process#heading--install-device\" rel=\"noopener nofollow ugc\"\u003eInstallation process\u003c/a\u003e in the Ubuntu Core documentation for more details.\u003c/p\u003e\n\u003ch2 id=\"heading--interface\"\u003eThe interface hooks\u003c/h2\u003e\n\u003cp\u003eInterface hooks are executed when an interface is either connected or disconnected via the interface’s plugs and slots mechanism.\u003c/p\u003e\n\u003cp\u003eThey can be used to read or write attributes from a connection and, for example, acquire new resources, update internal options or update databases.\u003c/p\u003e\n\u003cp\u003eFor further details, see \u003ca href=\"/t/interface-hooks/8214\"\u003eInterface hooks\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"heading--prepare-device\"\u003eThe prepare-device hook\u003c/h2\u003e\n\u003cp\u003eThis hook is only supported in gadget snaps.\u003c/p\u003e\n\u003cp\u003eSee \u003ca href=\"/t/the-gadget-snap/696\"\u003eThe gadget snap\u003c/a\u003e documentation for more details.\u003c/p\u003e\n\u003ch2 id=\"heading--pre-refresh\"\u003eThe pre-refresh hook\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003epre-refresh\u003c/code\u003e hook is called whenever the snap gets refreshed.\u003c/p\u003e\n\u003cp\u003eThis hook is executed for the already installed revision of the snap with its services still running (if the snap has any services) and before switching to the newly installed revision.\u003c/p\u003e\n\u003cp\u003eThis hook is a good place for any maintenance or cleanup actions that prepare the snap for switching to the new revision. It’s also a good place to test whether a refresh will succeed,  because if the test causes the hook to fail, the refresh will not proceed.\u003c/p\u003e\n\u003ch2 id=\"heading--post-refresh\"\u003eThe post-refresh hook\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003epost-refresh\u003c/code\u003e hook is similar to \u003ccode\u003epre-refresh\u003c/code\u003e (above) in that it is called whenever the snap gets refreshed.\u003c/p\u003e\n\u003cp\u003eThis hook is executed for the newly installed snap, before starting new services (if applicable). This hook is a good place for any extra actions that need to be performed for the new revision of the snap. It’s also a good place to test whether a refresh has succeeded, because if the test causes the hook to fail, the refresh will be rolled-back and the original state of the snap restored.\u003c/p\u003e\n\u003ch2 id=\"heading--remove\"\u003eThe remove hook\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003eremove\u003c/code\u003e hook is called when the last revision of the snap gets removed from the system.\u003c/p\u003e\n\u003cp\u003eThis hook is executed after stopping the services of the snap (if the snap has any services), therefore it’s useful for any custom cleanup logic.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2023-05-02T10:18:40.052Z","reply_count":4,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1855,"reads":239,"readers_count":238,"score":9332.8,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Wiki Content","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":38,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://ubuntu.com/core/docs/uc20/installation-process#heading--install-device","internal":false,"reflection":false,"title":"Installation process | Ubuntu","clicks":9},{"url":"https://forum.snapcraft.io/t/the-network-interface/7880","internal":true,"reflection":false,"title":"The network interface","clicks":5},{"url":"https://forum.snapcraft.io/t/interface-management/6154","internal":true,"reflection":false,"title":"Interface management","clicks":5},{"url":"https://forum.snapcraft.io/t/the-snapcraft-yaml-schema/8337","internal":true,"reflection":false,"title":"The snapcraft.yaml schema","clicks":0},{"url":"https://ubuntu.com/core/docs/uc20/","internal":false,"reflection":false,"clicks":0},{"url":"https://ubuntu.com/core/docs/uc20/full-disk-encryption","internal":false,"reflection":false,"title":"Full disk encryption | Ubuntu","clicks":0},{"url":"https://forum.snapcraft.io/t/gadget-snaps/696","internal":true,"reflection":false,"title":"Gadget snaps","clicks":0},{"url":"https://forum.snapcraft.io/t/interface-hooks/8214","internal":true,"reflection":true,"title":"Interface hooks","clicks":46},{"url":"https://forum.snapcraft.io/t/snapcraft-hook-support/19069","internal":true,"reflection":true,"title":"Snapcraft hook support","clicks":35},{"url":"https://forum.snapcraft.io/t/using-the-snapctl-tool/15002","internal":true,"reflection":true,"title":"Using the snapctl tool","clicks":16},{"url":"https://forum.snapcraft.io/t/adding-snap-configuration/15246","internal":true,"reflection":true,"title":"Adding snap configuration","clicks":13},{"url":"https://forum.snapcraft.io/t/hook-to-run-scripts-before-and-after-refresh/5892/2","internal":true,"reflection":true,"title":"Hook to run scripts before and after refresh","clicks":9},{"url":"https://forum.snapcraft.io/t/refresh-control/27213","internal":true,"reflection":true,"title":"Refresh control","clicks":6},{"url":"https://forum.snapcraft.io/t/disabling-automatic-refresh-for-snap-from-store/707/189","internal":true,"reflection":true,"title":"Disabling automatic refresh for snap from store","clicks":4},{"url":"https://forum.snapcraft.io/t/the-snap-format/698","internal":true,"reflection":true,"title":"The snap format","clicks":4},{"url":"https://forum.snapcraft.io/t/how-to-load-iptable-rules-on-startup-what-plugs-are-needed/4508/4","internal":true,"reflection":true,"title":"How to load Iptable rules on startup, what plugs are needed?","clicks":3},{"url":"https://forum.snapcraft.io/t/does-classic-allow-snaps-to-run-scripts-as-root/6607/2","internal":true,"reflection":true,"title":"Does --classic allow snaps to run scripts as root?","clicks":1},{"url":"https://forum.snapcraft.io/t/services-and-daemons/12601","internal":true,"reflection":true,"title":"Services and daemons","clicks":0},{"url":"https://forum.snapcraft.io/t/uc20-uc22-full-disk-encryption-hook-interface/24439","internal":true,"reflection":true,"title":"UC20/UC22 full-disk-encryption hook interface","clicks":0},{"url":"https://forum.snapcraft.io/t/data-and-config-file-questions/15935/2","internal":true,"reflection":true,"title":"Data and config file questions","clicks":0},{"url":"https://forum.snapcraft.io/t/managing-snap-configuration/510","internal":true,"reflection":true,"title":"Managing snap configuration","clicks":0},{"url":"https://forum.snapcraft.io/t/glossary/14612","internal":true,"reflection":true,"title":"Glossary","clicks":0},{"url":"https://forum.snapcraft.io/t/install-and-remove-hooks/2120/6","internal":true,"reflection":true,"title":"Install and remove hooks","clicks":0},{"url":"https://forum.snapcraft.io/t/snapcraft-yaml-reference/4276","internal":true,"reflection":true,"title":"Snapcraft.yaml reference","clicks":0},{"url":"https://forum.snapcraft.io/t/snapcraft-app-and-service-metadata/8335","internal":true,"reflection":true,"title":"Snapcraft app and service metadata","clicks":0},{"url":"https://forum.snapcraft.io/t/snap-epochs/10316","internal":true,"reflection":true,"title":"Snap epochs","clicks":0},{"url":"https://forum.snapcraft.io/t/snap-documentation-page-deprecated/3781","internal":true,"reflection":true,"title":"Snap Documentation (page deprecated)","clicks":0},{"url":"https://forum.snapcraft.io/t/snap-documentation/11127","internal":true,"reflection":true,"title":"Snap documentation","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1044,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":true,"last_wiki_edit":"2023-05-02T10:18:40.083Z","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":18772,"name":"Gustavo Niemeyer","username":"niemeyer","avatar_template":"/user_avatar/forum.snapcraft.io/niemeyer/{size}/4620_2.png","created_at":"2018-01-31T20:22:55.183Z","cooked":"\u003cp\u003eContent moved \u003ca href=\"https://github.com/snapcore/snapd/wiki/hooks\"\u003eout of the wiki\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e… and now polished it a bit further.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2018-01-31T20:45:20.709Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":7,"reads":144,"readers_count":143,"score":78.8,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Gustavo Niemeyer","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/snapcore/snapd/wiki/hooks","internal":false,"reflection":false,"title":"Hooks · snapcore/snapd Wiki · GitHub","clicks":27}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":true,"staff":true,"user_id":1,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":37084,"name":"Michael Vogt","username":"mvo","avatar_template":"/user_avatar/forum.snapcraft.io/mvo/{size}/4438_2.png","created_at":"2018-11-06T08:29:47.664Z","cooked":"\u003cp\u003eI think we should add \u003ccode\u003eset -e\u003c/code\u003e to the configure hook example - any objections?\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2018-11-06T08:29:47.664Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":98,"readers_count":97,"score":39.6,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Michael Vogt","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"policy-reviewers","title_is_group":false,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":true,"admin":false,"staff":true,"user_id":4,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":37137,"name":"Ian Johnson","username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","created_at":"2018-11-06T15:18:23.958Z","cooked":"\u003cp\u003eI think this should also link/mention the interface hooks from here: \u003ca href=\"https://forum.snapcraft.io/t/interface-hooks/8214\" class=\"inline-onebox\"\u003eInterface hooks\u003c/a\u003e\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2018-11-06T15:18:23.958Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":91,"readers_count":90,"score":23.2,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Ian Johnson","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://forum.snapcraft.io/t/interface-hooks/8214","internal":true,"reflection":false,"title":"Interface hooks","clicks":9}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":true,"admin":false,"staff":true,"user_id":2438,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":37138,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2018-11-06T15:23:32.472Z","cooked":"\u003caside class=\"quote no-group quote-modified\" data-username=\"ijohnson\" data-post=\"4\" data-topic=\"3795\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/ijohnson/40/2091_2.png\" class=\"avatar\"\u003e ijohnson:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eI think this should also link/mention the interface hooks from here: \u003ca href=\"https://forum.snapcraft.io/t/interface-hooks/8214\"\u003eInterface hooks \u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eThanks for the suggestion, but if I understand correctly, it already does (following the paragraph on interface hooks). We should maybe make the link more prominent.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2018-11-06T15:23:32.472Z","reply_count":1,"reply_to_post_number":4,"quote_count":1,"incoming_link_count":1,"reads":87,"readers_count":86,"score":27.4,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":37139,"name":"Ian Johnson","username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","created_at":"2018-11-06T15:24:02.082Z","cooked":"\u003cp\u003eAh sorry I misread thanks\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2018-11-06T15:24:02.082Z","reply_count":0,"reply_to_post_number":5,"quote_count":0,"incoming_link_count":4,"reads":86,"readers_count":85,"score":82.2,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Ian Johnson","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","reply_to_user":{"username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":true,"admin":false,"staff":true,"user_id":2438,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":55624,"name":"Artem Martynovich","username":"a_martynovich","avatar_template":"/user_avatar/forum.snapcraft.io/a_martynovich/{size}/4526_2.png","created_at":"2019-09-25T12:58:40.575Z","cooked":"\u003cp\u003eIs it possible to see what install hook prints to the console? Here’s my hook, a slightly modified example version:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e#!/bin/sh -e\n\n# Create a default config file\necho \"BEFORE BEFORE\"\necho \"sleep_time 5\" \u0026gt; \"$SNAP_DATA/hello.conf\"\necho \"AFTER AFTER\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe hello.conf gets created, but there’re no messages in the console where \u003ccode\u003esnap install\u003c/code\u003e was executed.\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2019-09-25T12:58:40.575Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":5,"reads":71,"readers_count":70,"score":44.2,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Artem Martynovich","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":5594,"hidden":false,"trust_level":0,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":55626,"name":"Ian Johnson","username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","created_at":"2019-09-25T13:38:10.919Z","cooked":"\u003cp\u003eThe output is only shown if the hook exits with non-zero exit code for debugging purposes.\u003c/p\u003e\n\u003cp\u003eWhat information are you trying to show to the user during the install?\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2019-09-25T13:38:10.919Z","reply_count":1,"reply_to_post_number":7,"quote_count":0,"incoming_link_count":1,"reads":67,"readers_count":66,"score":23.4,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Ian Johnson","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","reply_to_user":{"username":"a_martynovich","avatar_template":"/user_avatar/forum.snapcraft.io/a_martynovich/{size}/4526_2.png"},"bookmarked":false,"actions_summary":[],"moderator":true,"admin":false,"staff":true,"user_id":2438,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":55650,"name":"Artem Martynovich","username":"a_martynovich","avatar_template":"/user_avatar/forum.snapcraft.io/a_martynovich/{size}/4526_2.png","created_at":"2019-09-25T16:51:32.687Z","cooked":"\u003cp\u003eI’m trying to tell the user that manually connecting plugs is required after installation. Otherwise most of the functionality won’t work and the snap is useless (it needs several “unsafe” interfaces which don’t autoconnect).\u003c/p\u003e","post_number":9,"post_type":1,"updated_at":"2019-09-25T16:51:32.687Z","reply_count":1,"reply_to_post_number":8,"quote_count":0,"incoming_link_count":2,"reads":66,"readers_count":65,"score":28.2,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Artem Martynovich","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":5594,"hidden":false,"trust_level":0,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":55661,"name":"Ian Johnson","username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","created_at":"2019-09-25T18:28:14.214Z","cooked":"\u003cp\u003eHave you tried requesting auto-connection through the forum request documented at \u003ca href=\"https://forum.snapcraft.io/t/process-for-aliases-auto-connections-and-tracks/455\" class=\"inline-onebox\"\u003eProcess for aliases, auto-connections and tracks\u003c/a\u003e ?\u003c/p\u003e\n\u003cp\u003eAdditionally, you can prompt them from a GUI window or a message from the terminal when they first use your application. For example, a zenity GUI prompt is implemented here: \u003ca href=\"https://github.com/Lin-Buo-Ren/guvcview-snap/blob/master/snap/local/launchers/guvcview-launch#L12-L17\"\u003ehttps://github.com/Lin-Buo-Ren/guvcview-snap/blob/master/snap/local/launchers/guvcview-launch#L12-L17\u003c/a\u003e\u003c/p\u003e","post_number":10,"post_type":1,"updated_at":"2019-09-25T18:28:14.214Z","reply_count":0,"reply_to_post_number":9,"quote_count":0,"incoming_link_count":1,"reads":66,"readers_count":65,"score":18.2,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Ian Johnson","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/Lin-Buo-Ren/guvcview-snap/blob/master/snap/local/launchers/guvcview-launch#L12-L17","internal":false,"reflection":false,"title":"guvcview-snap/guvcview-launch at master · Lin-Buo-Ren/guvcview-snap · GitHub","clicks":4},{"url":"https://forum.snapcraft.io/t/process-for-aliases-auto-connections-and-tracks/455","internal":true,"reflection":false,"title":"Process for aliases, auto-connections and tracks","clicks":4}],"read":true,"user_title":"","reply_to_user":{"username":"a_martynovich","avatar_template":"/user_avatar/forum.snapcraft.io/a_martynovich/{size}/4526_2.png"},"bookmarked":false,"actions_summary":[],"moderator":true,"admin":false,"staff":true,"user_id":2438,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":65423,"name":"Robie Basak","username":"rbasak","avatar_template":"/letter_avatar/rbasak/{size}/5_6d6f4cde2641c35611d5cac2fb97c77e.png","created_at":"2020-03-24T13:21:23.657Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"wiki\" data-post=\"1\" data-topic=\"3795\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/wiki/40/425_2.png\" class=\"avatar\"\u003e wiki:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThis allows for changes to be rolled back or \u003cem\u003eunset\u003c/em\u003e if errors occur during the execution of a hook.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eExactly what happens if a hook fails? For example, can a pre-refresh or post-refresh hook be used to prevent a snap refreshing if the hook determines that the refresh won’t work? Is this defined behaviour that we can rely upon?\u003c/p\u003e","post_number":11,"post_type":1,"updated_at":"2020-03-24T13:21:23.657Z","reply_count":1,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":0,"reads":56,"readers_count":55,"score":31.2,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Robie Basak","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1940,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":65431,"name":"Ian Johnson","username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","created_at":"2020-03-24T14:30:25.226Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"rbasak\" data-post=\"11\" data-topic=\"3795\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/letter_avatar/rbasak/40/5_6d6f4cde2641c35611d5cac2fb97c77e.png\" class=\"avatar\"\u003e rbasak:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003ecan a pre-refresh or post-refresh hook be used to prevent a snap refreshing if the hook determines that the refresh won’t work?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eYes this behavior can be relied on.\u003c/p\u003e","post_number":12,"post_type":1,"updated_at":"2020-03-24T14:30:25.226Z","reply_count":1,"reply_to_post_number":11,"quote_count":1,"incoming_link_count":2,"reads":54,"readers_count":53,"score":55.8,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Ian Johnson","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[{"id":2,"count":2}],"moderator":true,"admin":false,"staff":true,"user_id":2438,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":65447,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2020-03-24T18:22:29.598Z","cooked":"\u003cp\u003eI’ve added a some extra text to the pre- and post-refresh hooks to hopefully make this behaviour and use-case clearer (cc \u003ca class=\"mention\" href=\"/u/rbasak\"\u003e@rbasak\u003c/a\u003e).\u003c/p\u003e","post_number":13,"post_type":1,"updated_at":"2020-03-24T18:22:29.598Z","reply_count":0,"reply_to_post_number":12,"quote_count":0,"incoming_link_count":0,"reads":55,"readers_count":54,"score":56.0,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":3}],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":74102,"name":"Robie Basak","username":"rbasak","avatar_template":"/letter_avatar/rbasak/{size}/5_6d6f4cde2641c35611d5cac2fb97c77e.png","created_at":"2020-07-03T12:37:16.400Z","cooked":"\u003cp\u003eWhat’s the precise context in which a hook is run? I’d like a \u003ccode\u003epost-refresh\u003c/code\u003e hook run \u003ccode\u003egit-ubuntu.self-test\u003c/code\u003e (\u003ccode\u003eself-test\u003c/code\u003e is defined in \u003ccode\u003esnapcraft.yaml\u003c/code\u003e as an app) to verify that the new snap will work correctly. \u003ccode\u003eself-test\u003c/code\u003e already has a carefully defined environment that matches the main \u003ccode\u003egit-ubuntu\u003c/code\u003e app’s environment precisely. How can I ensure that when I invoke this from the \u003ccode\u003epost-refresh\u003c/code\u003e hook, the context is identical? Do I need to manually set the environment from inside the hook to the same as that defined in \u003ccode\u003esnapcraft.yaml\u003c/code\u003e against \u003ccode\u003eself-test\u003c/code\u003e? Or is there a better way?\u003c/p\u003e","post_number":14,"post_type":1,"updated_at":"2020-07-03T12:37:51.761Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":54,"readers_count":53,"score":15.8,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Robie Basak","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1940,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":74287,"name":"Ian Johnson","username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","created_at":"2020-07-06T19:07:22.934Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"rbasak\" data-post=\"14\" data-topic=\"3795\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/letter_avatar/rbasak/40/5_6d6f4cde2641c35611d5cac2fb97c77e.png\" class=\"avatar\"\u003e rbasak:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eDo I need to manually set the environment from inside the hook to the same as that defined in \u003ccode\u003esnapcraft.yaml\u003c/code\u003e against \u003ccode\u003eself-test\u003c/code\u003e ?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eYes\u003c/p\u003e\n\u003caside class=\"quote no-group\" data-username=\"rbasak\" data-post=\"14\" data-topic=\"3795\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/letter_avatar/rbasak/40/5_6d6f4cde2641c35611d5cac2fb97c77e.png\" class=\"avatar\"\u003e rbasak:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eOr is there a better way?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eUnfortunately not, what can make this slightly better is that if you don’t use the environment keyword for your self-test app, and do all setup except for running the app itself inside a script, you can then specify that script as a command-chain which can be shared between the app and the post-refresh hook with yaml like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-yaml\"\u003ehooks:\n  post-refresh:\n    command-chain:\n      - setup-self-test-env.sh\napps:\n  self-test:\n    command: do-the-test.sh\n    command-chain:\n      - setup-self-test-env.sh\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ethen in your \u003ccode\u003epost-refresh\u003c/code\u003e hook you just call \u003ccode\u003edo-the-test.sh\u003c/code\u003e directly. Alternatively, you could make the \u003ccode\u003epost-refresh\u003c/code\u003e file itself a symlink to \u003ccode\u003edo-the-test.sh\u003c/code\u003e if you don’t need to do anything else in the \u003ccode\u003epost-refresh\u003c/code\u003e hook\u003c/p\u003e","post_number":15,"post_type":1,"updated_at":"2020-07-06T19:07:22.934Z","reply_count":0,"reply_to_post_number":14,"quote_count":1,"incoming_link_count":0,"reads":53,"readers_count":52,"score":25.6,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Ian Johnson","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":true,"admin":false,"staff":true,"user_id":2438,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":79131,"name":"Sergio Schvezov","username":"sergiusens","avatar_template":"/user_avatar/forum.snapcraft.io/sergiusens/{size}/5621_2.png","created_at":"2020-09-23T00:05:12.852Z","cooked":"\u003cp\u003eOne thing I do not see documented is when to these hooks run relative to others and if the run before or after interfaces are connected\u003c/p\u003e","post_number":16,"post_type":1,"updated_at":"2020-09-23T00:05:12.852Z","reply_count":2,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":42,"readers_count":41,"score":33.4,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Sergio Schvezov","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"policy-reviewers","title_is_group":false,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":true,"admin":false,"staff":true,"user_id":25,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":83784,"name":"Ian Johnson","username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","created_at":"2020-12-09T16:16:25.841Z","cooked":"\u003cp\u003ealso before or after services are started for i.e. first boot of an ubuntu core system with the snap seeded or just for initial installation\u003c/p\u003e","post_number":17,"post_type":1,"updated_at":"2020-12-09T16:16:25.841Z","reply_count":0,"reply_to_post_number":16,"quote_count":0,"incoming_link_count":0,"reads":37,"readers_count":36,"score":7.4,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Ian Johnson","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","reply_to_user":{"username":"sergiusens","avatar_template":"/user_avatar/forum.snapcraft.io/sergiusens/{size}/5621_2.png"},"bookmarked":false,"actions_summary":[],"moderator":true,"admin":false,"staff":true,"user_id":2438,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":97691,"name":"Jochen","username":"mapero","avatar_template":"/user_avatar/forum.snapcraft.io/mapero/{size}/7434_2.png","created_at":"2021-08-17T07:27:24.676Z","cooked":"\u003cp\u003eHi \u003ca class=\"mention\" href=\"/u/sergiusens\"\u003e@sergiusens\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003edo you have information about this? We ran into some trouble during first boot on this.\u003cbr\u003e\nWe have a required snap that runs an install hook. Is this hook executed before or after the auto-connected interfaces?\u003c/p\u003e\n\u003cp\u003eParticularly we want to create a folder structure for a content-interface before any snap can write to this location. Both snaps are required snaps during image build. Currently we have this logic in the install hook of the slot snap.\u003c/p\u003e","post_number":18,"post_type":1,"updated_at":"2021-08-17T07:27:24.676Z","reply_count":0,"reply_to_post_number":16,"quote_count":0,"incoming_link_count":1,"reads":27,"readers_count":26,"score":10.4,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Jochen","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"sergiusens","avatar_template":"/user_avatar/forum.snapcraft.io/sergiusens/{size}/5621_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":8808,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":98301,"name":"Fabio Colella","username":"fcole90","avatar_template":"/user_avatar/forum.snapcraft.io/fcole90/{size}/6214_2.png","created_at":"2021-08-27T15:28:53.751Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"wiki\" data-post=\"1\" data-topic=\"3795\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/wiki/40/425_2.png\" class=\"avatar\"\u003e wiki:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe hook is executed before starting snap services (if it has any) and before the \u003ccode\u003econfigure\u003c/code\u003e hook. The install hook is the place for one-time actions, such as an early initialisation of a resource when installed for the first time.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eCan we use an install hook to prompt the user for things like username and password in order to log into a service? If not, what approach do you suggest? \u003cimg src=\"https://forum.snapcraft.io/images/emoji/emoji_one/blush.png?v=9\" title=\":blush:\" class=\"emoji\" alt=\":blush:\"\u003e\u003c/p\u003e","post_number":19,"post_type":1,"updated_at":"2021-08-27T15:28:53.751Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":0,"reads":25,"readers_count":24,"score":5.0,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Fabio Colella","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":335,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":98302,"name":"Fabio Colella","username":"fcole90","avatar_template":"/user_avatar/forum.snapcraft.io/fcole90/{size}/6214_2.png","created_at":"2021-08-27T15:32:11.562Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"wiki\" data-post=\"1\" data-topic=\"3795\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/wiki/40/425_2.png\" class=\"avatar\"\u003e wiki:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eA hook is defined as an executable within a snap’s \u003ccode\u003emeta/hooks/\u003c/code\u003e directory, and consequently, also within \u003ccode\u003esnap/hooks/\u003c/code\u003e when building with \u003cem\u003esnapcraft\u003c/em\u003e. See \u003ca href=\"/t/snapcraft-hook-support/19069\"\u003eSnapcraft hook support\u003c/a\u003e for more information.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eI would suggest merging the mentioned page with this. So much information is accumulating about snaps, and every time I find very difficult to find what I need \u003cimg src=\"https://forum.snapcraft.io/images/emoji/emoji_one/confused.png?v=9\" title=\":confused:\" class=\"emoji\" alt=\":confused:\"\u003e I really like snaps, but as the complexity is growing, the documentation is becoming overwhelming \u003cimg src=\"https://forum.snapcraft.io/images/emoji/emoji_one/frowning_face.png?v=9\" title=\":frowning_face:\" class=\"emoji\" alt=\":frowning_face:\"\u003e\u003c/p\u003e","post_number":20,"post_type":1,"updated_at":"2021-08-27T15:32:11.562Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":1,"reads":23,"readers_count":22,"score":9.6,"yours":false,"topic_id":3795,"topic_slug":"supported-snap-hooks","display_username":"Fabio Colella","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":335,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[18770,18772,37084,37137,37138,37139,55624,55626,55650,55661,65423,65431,65447,74102,74287,79131,83784,97691,98301,98302,104776,104867,108689,109778,114981,122030]},"timeline_lookup":[[1,1961],[3,1683],[4,1682],[7,1360],[9,1359],[11,1179],[12,1178],[14,1078],[15,1074],[16,996],[17,918],[18,668],[19,657],[21,507],[22,505],[23,413],[24,389],[25,247],[26,72]],"tags":[],"id":3795,"title":"Supported snap hooks","fancy_title":"Supported snap hooks","posts_count":26,"created_at":"2018-01-31T20:20:44.128Z","views":16455,"reply_count":11,"like_count":12,"last_posted_at":"2023-04-05T11:52:03.526Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"supported-snap-hooks","category_id":15,"word_count":2972,"deleted_at":null,"user_id":1044,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_3795","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":26,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"topic_timer":null,"message_bus_last_id":0,"participant_count":13,"show_read_indicator":false,"thumbnails":null,"details":{"notification_level":1,"participants":[{"id":2438,"username":"ijohnson","name":"Ian Johnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","post_count":7,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","post_count":3,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":11710,"username":"rpjday","name":"Robert P. J. Day","avatar_template":"/user_avatar/forum.snapcraft.io/rpjday/{size}/8457_2.png","post_count":3,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":5594,"username":"a_martynovich","name":"Artem Martynovich","avatar_template":"/user_avatar/forum.snapcraft.io/a_martynovich/{size}/4526_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":335,"username":"fcole90","name":"Fabio Colella","avatar_template":"/user_avatar/forum.snapcraft.io/fcole90/{size}/6214_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1940,"username":"rbasak","name":"Robie Basak","avatar_template":"/letter_avatar/rbasak/{size}/5_6d6f4cde2641c35611d5cac2fb97c77e.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1,"username":"niemeyer","name":"Gustavo Niemeyer","avatar_template":"/user_avatar/forum.snapcraft.io/niemeyer/{size}/4620_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":11862,"username":"RohitRC","name":"Rohit Roy Chowdhury","avatar_template":"/letter_avatar/rohitrc/{size}/5_6d6f4cde2641c35611d5cac2fb97c77e.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":4,"username":"mvo","name":"Michael Vogt","avatar_template":"/user_avatar/forum.snapcraft.io/mvo/{size}/4438_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":25,"username":"sergiusens","name":"Sergio Schvezov","avatar_template":"/user_avatar/forum.snapcraft.io/sergiusens/{size}/5621_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":330,"username":"awe","name":"Tony Espy","avatar_template":"/user_avatar/forum.snapcraft.io/awe/{size}/266_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1044,"username":"wiki","name":"Wiki Content","avatar_template":"/user_avatar/forum.snapcraft.io/wiki/{size}/425_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":8808,"username":"mapero","name":"Jochen","avatar_template":"/user_avatar/forum.snapcraft.io/mapero/{size}/7434_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null}],"created_by":{"id":1044,"username":"wiki","name":"Wiki Content","avatar_template":"/user_avatar/forum.snapcraft.io/wiki/{size}/425_2.png"},"last_poster":{"id":11710,"username":"rpjday","name":"Robert P. J. Day","avatar_template":"/user_avatar/forum.snapcraft.io/rpjday/{size}/8457_2.png"},"links":[{"url":"https://forum.snapcraft.io/t/interface-hooks/8214","title":"Interface hooks","internal":true,"attachment":false,"reflection":true,"clicks":46,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/snapcraft-hook-support/19069","title":"Snapcraft hook support","internal":true,"attachment":false,"reflection":true,"clicks":35,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/snapcore/snapd/wiki/hooks","title":"Hooks · snapcore/snapd Wiki · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":27,"user_id":1,"domain":"github.com","root_domain":"github.com"},{"url":"https://forum.snapcraft.io/t/using-the-snapctl-tool/15002","title":"Using the snapctl tool","internal":true,"attachment":false,"reflection":true,"clicks":16,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/adding-snap-configuration/15246","title":"Adding snap configuration","internal":true,"attachment":false,"reflection":true,"clicks":13,"user_id":1418,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://ubuntu.com/core/docs/uc20/installation-process#heading--install-device","title":"Installation process | Ubuntu","internal":false,"attachment":false,"reflection":false,"clicks":9,"user_id":1044,"domain":"ubuntu.com","root_domain":"ubuntu.com"},{"url":"https://forum.snapcraft.io/t/hook-to-run-scripts-before-and-after-refresh/5892/2","title":"Hook to run scripts before and after refresh","internal":true,"attachment":false,"reflection":true,"clicks":9,"user_id":1,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/interface-hooks/8214","title":"Interface hooks","internal":true,"attachment":false,"reflection":false,"clicks":9,"user_id":2438,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/refresh-control/27213","title":"Refresh control","internal":true,"attachment":false,"reflection":true,"clicks":6,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/interface-management/6154","title":"Interface management","internal":true,"attachment":false,"reflection":false,"clicks":5,"user_id":1044,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/the-network-interface/7880","title":"The network interface","internal":true,"attachment":false,"reflection":false,"clicks":5,"user_id":1044,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/disabling-automatic-refresh-for-snap-from-store/707/189","title":"Disabling automatic refresh for snap from store","internal":true,"attachment":false,"reflection":true,"clicks":4,"user_id":1,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/process-for-aliases-auto-connections-and-tracks/455","title":"Process for aliases, auto-connections and tracks","internal":true,"attachment":false,"reflection":false,"clicks":4,"user_id":2438,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/the-snap-format/698","title":"The snap format","internal":true,"attachment":false,"reflection":true,"clicks":4,"user_id":1044,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/Lin-Buo-Ren/guvcview-snap/blob/master/snap/local/launchers/guvcview-launch#L12-L17","title":"guvcview-snap/guvcview-launch at master · Lin-Buo-Ren/guvcview-snap · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":4,"user_id":2438,"domain":"github.com","root_domain":"github.com"},{"url":"https://forum.snapcraft.io/t/how-to-load-iptable-rules-on-startup-what-plugs-are-needed/4508/4","title":"How to load Iptable rules on startup, what plugs are needed?","internal":true,"attachment":false,"reflection":true,"clicks":3,"user_id":21,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/does-classic-allow-snaps-to-run-scripts-as-root/6607/2","title":"Does --classic allow snaps to run scripts as root?","internal":true,"attachment":false,"reflection":true,"clicks":1,"user_id":393,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://snapcraft.io/docs/snapcraft-yaml-reference","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":330,"domain":"snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/health-checks/10605","title":"Health Checks","internal":true,"attachment":false,"reflection":false,"clicks":1,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"}]}}