{"post_stream":{"posts":[{"id":20689,"name":"Wiki Content","username":"wiki","avatar_template":"/user_avatar/forum.snapcraft.io/wiki/{size}/425_2.png","created_at":"2018-02-22T23:59:02.198Z","cooked":"\u003cp\u003e\u003ca href=\"/t/snapcraft-overview/8940\"\u003eSnapcraft\u003c/a\u003e, the snap-building tool, is designed to use \u003ca href=\"https://community.ubuntu.com/t/installing-multipass-on-linux/8328\" rel=\"noopener nofollow ugc\"\u003eMultipass\u003c/a\u003e and \u003ca href=\"/t/base-snaps/11198\"\u003ebases\u003c/a\u003e to both simplify the build process and to confine the build environment within a virtual machine. This mostly removes the need to use Docker.\u003c/p\u003e\n\u003cp\u003eHowever, Docker can still be used, and is particularly useful when you’re already using Docker within your build and test infrastructure.\nAll you need is a working \u003cem\u003esnapcraft.yaml\u003c/em\u003e (see \u003ca href=\"/t/creating-a-snap/6799\"\u003eCreating a snap\u003c/a\u003e for more details).\u003c/p\u003e\n\u003caside class=\"quote no-group\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cimg src=\"https://forum.snapcraft.io/images/emoji/emoji_one/information_source.png?v=9\" title=\":information_source:\" class=\"emoji\" alt=\":information_source:\"\u003e Electron apps are built slightly differently, and do not use a \u003ccode\u003esnapcraft.yaml\u003c/code\u003e file.  \u003ca href=\"/t/electron-apps/6748\"\u003eFollow this guide\u003c/a\u003e to build a snap of an Electron app using electron-builder.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eTo create a snap with Docker, first make sure you have \u003ca href=\"https://docs.docker.com/install/\" rel=\"noopener nofollow ugc\"\u003eDocker installed\u003c/a\u003e. You can test that Docker is correctly set up with:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-bash\"\u003e$ docker run hello-world\n[...]\nStatus: Downloaded newer image for hello-world:latest\n\nHello from Docker!\n[...]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf you don’t see the “Hello from Docker!” message, consult the \u003ca href=\"https://docs.docker.com/install/linux/linux-postinstall/\" rel=\"noopener nofollow ugc\"\u003eDocker documentation\u003c/a\u003e for troubleshooting steps.\u003c/p\u003e\n\u003ch3\u003eSnaps using bases\u003c/h3\u003e\n\u003cp\u003eWhen using a \u003ca href=\"/t/base-snaps/11198\"\u003ebase snaps\u003c/a\u003e other than \u003ccode\u003ecore\u003c/code\u003e, a custom Docker image will need to be built. For details, see \u003ca href=\"/t/creating-docker-images-for-snapcraft/11739\"\u003eCreating docker images for snapcraft\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe process for building a \u003ccode\u003ecore18\u003c/code\u003e compatible image, the default for \u003ca href=\"/t/release-notes-snapcraft-3-0/10704\"\u003eSnapcraft 3.x\u003c/a\u003e, is outlined below.\u003c/p\u003e\n\u003cp\u003eDocker images are built from a \u003ca href=\"https://docs.docker.com/engine/reference/builder/\" rel=\"noopener nofollow ugc\"\u003eDockerfile\u003c/a\u003e. This is a script that  Docker interprets to assemble whatever is required to generate the image.\u003c/p\u003e\n\u003cp\u003eThe following is an example Dockerfile to build a \u003ccode\u003ecore18\u003c/code\u003e compatible image:\u003c/p\u003e\n\u003cdetails\u003e\n\u003csummary\u003e\nstable.Dockerfile for core18\u003c/summary\u003e\n\u003cpre\u003e\u003ccode\u003eFROM ubuntu:bionic as builder\n\n# Grab dependencies\nRUN apt update\nRUN apt dist-upgrade --yes\nRUN apt install --yes \\\n      curl \\\n      sudo \\\n      jq \\\n      squashfs-tools\n\n# Grab the core snap from the stable channel and unpack it in the proper place\n# (the 'Snap-CDN: none' header allows building in restricted network\n# environments such as Launchpad builders)\nRUN curl -L -H 'Snap-CDN: none' $(curl -H 'X-Ubuntu-Series: 16' 'https://api.snapcraft.io/api/v1/snaps/details/core' | jq '.download_url' -r) --output core.snap\nRUN mkdir -p /snap/core\nRUN unsquashfs -d /snap/core/current core.snap\n\n# Grab the core18 snap from the stable channel and unpack it in the proper place\nRUN curl -L -H 'Snap-CDN: none' $(curl -H 'X-Ubuntu-Series: 16' 'https://api.snapcraft.io/api/v1/snaps/details/core18' | jq '.download_url' -r) --output core18.snap\nRUN mkdir -p /snap/core18\nRUN unsquashfs -d /snap/core18/current core18.snap\n\n# Grab the snapcraft snap from the stable channel and unpack it in the proper place\nRUN curl -L -H 'Snap-CDN: none' $(curl -H 'X-Ubuntu-Series: 16' 'https://api.snapcraft.io/api/v1/snaps/details/snapcraft?channel=stable' | jq '.download_url' -r) --output snapcraft.snap\nRUN mkdir -p /snap/snapcraft\nRUN unsquashfs -d /snap/snapcraft/current snapcraft.snap\n\n# Create a snapcraft runner\nRUN mkdir -p /snap/bin\nRUN echo \"#!/bin/sh\" \u0026gt; /snap/bin/snapcraft\nRUN snap_version=\"$(awk '/^version:/{print $2}' /snap/snapcraft/current/meta/snap.yaml)\" \u0026amp;\u0026amp; echo \"export SNAP_VERSION=\\\"$snap_version\\\"\" \u0026gt;\u0026gt; /snap/bin/snapcraft\nRUN echo 'exec \"$SNAP/usr/bin/python3\" \"$SNAP/bin/snapcraft\" \"$@\"' \u0026gt;\u0026gt; /snap/bin/snapcraft\nRUN chmod +x /snap/bin/snapcraft\n\n# Multi-stage build, only need the snaps from the builder. Copy them one at a\n# time so they can be cached.\nFROM ubuntu:bionic\nCOPY --from=builder /snap/core /snap/core\nCOPY --from=builder /snap/core18 /snap/core18\nCOPY --from=builder /snap/snapcraft /snap/snapcraft\nCOPY --from=builder /snap/bin/snapcraft /snap/bin/snapcraft\n\n# Generate locale\nRUN apt update \u0026amp;\u0026amp; apt dist-upgrade --yes \u0026amp;\u0026amp; apt install --yes sudo snapd locales \u0026amp;\u0026amp; locale-gen en_US.UTF-8\n\n# Set the proper environment\nENV LANG=\"en_US.UTF-8\"\nENV LANGUAGE=\"en_US:en\"\nENV LC_ALL=\"en_US.UTF-8\"\nENV PATH=\"/snap/bin:$PATH\"\nENV SNAP=\"/snap/snapcraft/current\"\nENV SNAP_NAME=\"snapcraft\"\nENV SNAP_ARCH=\"amd64\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/details\u003e\n\u003cp\u003eDockerfiles for the Snapcraft project, including files that can be built with \u003cem\u003esnapd\u003c/em\u003e from different channels, can be found on \u003ca href=\"https://github.com/snapcore/snapcraft/tree/master/docker\" rel=\"noopener nofollow ugc\"\u003eSnapcraft’s GitHub\u003c/a\u003e repository.\u003c/p\u003e\n\u003cp\u003eTo build a Docker image, enter the following command from the same location as the saved version of the Dockerfile, which we’ve called \u003ccode\u003estable.Dockerfile\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-bash\"\u003e$ docker build --no-cache -f stable.Dockerfile --label mycustomimage --tag mycustomimage:stable --network host .\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhen the process has completed, you should be able to see the new image in the output from \u003ccode\u003edocker images\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-bash\"\u003eREPOSITORY      TAG       IMAGE ID       CREATED              SIZE\nmycustomimage   stable    76dcf5eafcd2   About a minute ago   882MB\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eSnaps without bases\u003c/h3\u003e\n\u003cp\u003eIf your \u003ccode\u003esnapcraft.yaml\u003c/code\u003e has no \u003ccode\u003ebase\u003c/code\u003e entry or \u003ccode\u003ebase: core\u003c/code\u003e defined, you can simply pull down the latest snapcraft image:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-bash\"\u003e$ docker pull snapcore/snapcraft:stable\n[...]\nStatus: Downloaded newer image for snapcore/snapcraft:stable\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eRunning a build\u003c/h2\u003e\n\u003cp\u003eAfter either building or downloading the snapcraft Docker image, return to the root directory of the project containing your snapcraft.yaml and run snapcraft:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-bash\"\u003e$ docker run -v \"$PWD\":/build -w /build \u0026lt;IMAGE-NAME\u0026gt; snapcraft\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eRepleace \u003ccode\u003e\u0026lt;IMAGE-NAME\u0026gt;\u003c/code\u003e with either the name of your manually built Docker image, \u003ccode\u003emycustomimage:stable\u003c/code\u003e in our example above, or the downloaded image, such as \u003ccode\u003esnapcore/snapcraft:stable\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThese options instruct Docker to map the current directory, your project root, to the \u003ccode\u003e/snapcraft_build\u003c/code\u003e directory inside the container, and then start the \u003ccode\u003esnapcraft\u003c/code\u003e command (the final command-line argument) from this same location inside the container.\u003c/p\u003e\n\u003cp\u003eWhen the snap build completes successfully, you will find a \u003ccode\u003e.snap\u003c/code\u003e file in the current directory. You can inspect its contents to ensure it contains all of your application’s assets:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-bash\"\u003e$ unsquashfs -l *.snap\n\u003c/code\u003e\u003c/pre\u003e\n\u003caside class=\"quote no-group\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cimg src=\"https://forum.snapcraft.io/images/emoji/emoji_one/warning.png?v=9\" title=\":warning:\" class=\"emoji\" alt=\":warning:\"\u003e Docker may contaminate your project directory with files owned by \u003ccode\u003eroot\u003c/code\u003e, causing \u003cem\u003epermission denied\u003c/em\u003e errors. Use \u003ccode\u003esudo chown --changes --recursive $USER:$USER _project_folder_\u003c/code\u003e to regain ownership of these files.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003ch3\u003eNext steps\u003c/h3\u003e\n\u003cp\u003eAfter creating a snap, you should upload it to the \u003ca href=\"https://snapcraft.io/store\" rel=\"noopener nofollow ugc\"\u003eSnap Store\u003c/a\u003e, from where it can reach a potential audience of millions. See \u003ca href=\"/t/releasing-your-app/6795\"\u003eReleasing your app\u003c/a\u003e for further details.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2021-11-02T21:38:45.176Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":653,"reads":92,"readers_count":91,"score":3298.4,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Wiki Content","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":28,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://forum.snapcraft.io/t/creating-docker-images-for-snapcraft/11739","internal":true,"reflection":false,"title":"Creating docker images for snapcraft","clicks":17},{"url":"https://github.com/snapcore/snapcraft/tree/master/docker","internal":false,"reflection":false,"title":"snapcraft/docker at master · snapcore/snapcraft · GitHub","clicks":7},{"url":"https://forum.snapcraft.io/t/releasing-your-app/6795","internal":true,"reflection":false,"title":"Releasing your app","clicks":3},{"url":"https://forum.snapcraft.io/t/base-snaps/11198","internal":true,"reflection":false,"title":"Base snaps","clicks":3},{"url":"https://forum.snapcraft.io/t/creating-a-snap/6799","internal":true,"reflection":false,"title":"Creating a snap","clicks":2},{"url":"https://forum.snapcraft.io/t/release-notes-snapcraft-3-0/10704","internal":true,"reflection":false,"title":"Release notes: Snapcraft 3.0","clicks":1},{"url":"https://community.ubuntu.com/t/installing-multipass-on-linux/8328","internal":false,"reflection":false,"title":"Installing Multipass on Linux - Documentation - Ubuntu Community Hub","clicks":1},{"url":"https://docs.docker.com/install/","internal":false,"reflection":false,"title":"About Docker CE | Docker Documentation","clicks":1},{"url":"https://snapcraft.io/store","internal":false,"reflection":false,"title":"Install Linux apps using the Snap Store | Snapcraft","clicks":1},{"url":"https://docs.docker.com/engine/reference/builder/","internal":false,"reflection":false,"title":"| Docker Documentation","clicks":0},{"url":"https://forum.snapcraft.io/t/snapcraft-overview/8940","internal":true,"reflection":false,"title":"Snapcraft overview","clicks":0},{"url":"https://docs.docker.com/install/linux/linux-postinstall/","internal":false,"reflection":false,"title":"Post-installation steps for Linux | Docker Documentation","clicks":0},{"url":"https://forum.snapcraft.io/t/building-the-snap/6800","internal":true,"reflection":true,"title":"Building the snap","clicks":1},{"url":"https://forum.snapcraft.io/t/snap-documentation-page-deprecated/3781","internal":true,"reflection":true,"title":"Snap Documentation (page deprecated)","clicks":0},{"url":"https://forum.snapcraft.io/t/snap-documentation/11127","internal":true,"reflection":true,"title":"Snap documentation","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1044,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":true,"last_wiki_edit":"2021-11-02T21:38:45.201Z","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":20697,"name":"Kyle Fazzari","username":"kyrofa","avatar_template":"/user_avatar/forum.snapcraft.io/kyrofa/{size}/4384_2.png","created_at":"2018-02-23T00:50:50.230Z","cooked":"\u003cp\u003eYou can also use the snapcore/snapcraft image.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2018-02-23T00:50:50.230Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":72,"readers_count":71,"score":34.4,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Kyle Fazzari","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":17,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":20703,"name":"Brett Sutton","username":"bsutton","avatar_template":"/user_avatar/forum.snapcraft.io/bsutton/{size}/4941_2.png","created_at":"2018-02-23T01:38:29.064Z","cooked":"\u003cp\u003enot certain what that means.\u003c/p\u003e\n\u003cp\u003eDo you mean there is a docker snapcore/snapcraft image ?\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2018-02-23T01:38:29.064Z","reply_count":0,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":2,"reads":69,"readers_count":68,"score":23.8,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Brett Sutton","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"kyrofa","avatar_template":"/user_avatar/forum.snapcraft.io/kyrofa/{size}/4384_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1814,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":20704,"name":"Kyle Fazzari","username":"kyrofa","avatar_template":"/user_avatar/forum.snapcraft.io/kyrofa/{size}/4384_2.png","created_at":"2018-02-23T01:40:47.461Z","cooked":"\u003cp\u003eIndeed: \u003ca href=\"https://hub.docker.com/r/snapcore/snapcraft/\"\u003ehttps://hub.docker.com/r/snapcore/snapcraft/\u003c/a\u003e\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2018-02-23T01:40:47.461Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":6,"reads":63,"readers_count":62,"score":57.6,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Kyle Fazzari","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://hub.docker.com/r/snapcore/snapcraft/","internal":false,"reflection":false,"clicks":20}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":17,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":33371,"name":"林博仁(Buo-ren, Lin)","username":"Lin-Buo-Ren","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png","created_at":"2018-09-10T05:29:37.345Z","cooked":"\u003cp\u003eThis topic duplicates with \u003ca href=\"https://forum.snapcraft.io/t/building-the-snap-on-docker/6757\" class=\"inline-onebox\"\u003eBuilding the snap on Docker\u003c/a\u003e, maybe merge to one of them?\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2018-09-10T05:29:37.345Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":54,"readers_count":53,"score":30.8,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"林博仁(Buo-ren, Lin)","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://forum.snapcraft.io/t/building-the-snap-on-docker/6757","internal":true,"reflection":false,"title":"Building the snap on Docker","clicks":18}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1417,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":36734,"name":"Ian Johnson","username":"ijohnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","created_at":"2018-10-30T19:39:07.658Z","cooked":"\u003cp\u003eI agree, I think this topic should be closed and point to the other one\u003c/p\u003e\n\u003cp\u003eAlso, the other topic reads better on \u003ca href=\"http://docs.snapcraft.io\"\u003edocs.snapcraft.io\u003c/a\u003e: \u003ca href=\"https://docs.snapcraft.io/building-the-snap-on-docker/6757\"\u003ehttps://docs.snapcraft.io/building-the-snap-on-docker/6757\u003c/a\u003e reads better and is more consistent than \u003ca href=\"https://docs.snapcraft.io/build-on-docker/4158\"\u003ehttps://docs.snapcraft.io/build-on-docker/4158\u003c/a\u003e, which also appears to suffer from some formatting issues converting from here\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2018-10-30T19:39:07.658Z","reply_count":0,"reply_to_post_number":5,"quote_count":0,"incoming_link_count":3,"reads":47,"readers_count":46,"score":39.4,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Ian Johnson","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://docs.snapcraft.io/building-the-snap-on-docker/6757","internal":false,"reflection":false,"title":"Building the snap on Docker - Documentation for snaps: Universal Linux packages","clicks":5},{"url":"http://docs.snapcraft.io","internal":false,"reflection":false,"clicks":1},{"url":"https://docs.snapcraft.io/build-on-docker/4158","internal":false,"reflection":false,"title":"Build on Docker - Documentation for snaps: Universal Linux packages","clicks":0}],"read":true,"user_title":"","reply_to_user":{"username":"Lin-Buo-Ren","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":true,"admin":false,"staff":true,"user_id":2438,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":37362,"name":"Igor Kupczyński","username":"igorkupczynski","avatar_template":"/letter_avatar/igorkupczynski/{size}/5_6d6f4cde2641c35611d5cac2fb97c77e.png","created_at":"2018-11-08T22:32:31.787Z","cooked":"\u003cp\u003eHello,\u003c/p\u003e\n\u003cp\u003eI think this doc should be superseded by \u003ca href=\"https://docs.snapcraft.io/building-the-snap-on-docker/6757\" rel=\"noopener nofollow ugc\"\u003ehttps://docs.snapcraft.io/building-the-snap-on-docker/6757\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFirst of all, it gives docker installation instruction which seems out of scope (and a moving target depending on version of ubuntu and docker).\u003c/p\u003e\n\u003cp\u003eThen it uses \u003ccode\u003esudo\u003c/code\u003e to interact with docker, which is not needed if the user is in the \u003ccode\u003edocker\u003c/code\u003e group.\u003c/p\u003e\n\u003cp\u003eFinally, it forgets to mention the command to be run against the docker container, so:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ sudo docker run -v \"$PWD\":/snapcraft_build \\\n       -w /snapcraft_build snapcore/snapcraft \n$ snapcraft\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis doesn’t result in an interactive shell, so either it should be something like (\u003ccode\u003e-it\u003c/code\u003e was added to \u003ccode\u003eKeep STDIN open even if not attached\u003c/code\u003e and \u003ccode\u003eAllocate a pseudo-TTY\u003c/code\u003e; we could also add \u003ccode\u003e--rm\u003c/code\u003e to clean after the operation):\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ docker run -it -v \"$PWD:/snapcraft_build\" -w /snapcraft_build snapcore/snapcraft\n# snapcraft       // \u0026lt;-- this is being executed within the container\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOr something like the other page suggests (different folder names don’t matter, but \u003ccode\u003esnapcraft\u003c/code\u003e at the end does).\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ docker run -v \"$PWD\":/build -w /build snapcore/snapcraft snapcraft\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnother things is that we need more than just \u003ccode\u003esnapcraft\u003c/code\u003e, see \u003ca href=\"https://forum.snapcraft.io/t/building-the-snap-on-docker/6757/2\" class=\"inline-onebox\"\u003eBuilding the snap on Docker\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eI think this should be updated to mention that before running snapcraft from the container, apt update needs to be run, because as it is the snapcore/snapcraft docker image has out of date apt sources and as such snapcraft will fail to install/download packages when using apt because the sources/sites are out of date\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eWhat do you folks think?\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2018-11-08T22:32:31.787Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":7,"reads":45,"readers_count":44,"score":64.0,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Igor Kupczyński","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://docs.snapcraft.io/building-the-snap-on-docker/6757","internal":false,"reflection":false,"title":"Building the snap on Docker - Documentation for snaps: Universal Linux packages","clicks":30},{"url":"https://forum.snapcraft.io/t/building-the-snap-on-docker/6757/2","internal":true,"reflection":false,"title":"Building the snap on Docker","clicks":7},{"url":"https://forum.snapcraft.io/t/building-the-snap-on-docker/6757/3","internal":true,"reflection":true,"title":"Building the snap on Docker","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":3513,"hidden":false,"trust_level":0,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":37363,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2018-11-08T22:39:45.312Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"igorkupczynski\" data-post=\"7\" data-topic=\"4158\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/letter_avatar/igorkupczynski/40/5_6d6f4cde2641c35611d5cac2fb97c77e.png\" class=\"avatar\"\u003e igorkupczynski:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eI think this doc should be superseded by \u003ca href=\"https://docs.snapcraft.io/building-the-snap-on-docker/6757\"\u003ehttps://docs.snapcraft.io/building-the-snap-on-docker/6757\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eThanks for the input on this important topic. And yes, we should have only a single doc for Docker - and make sure it works - I’ll look into merging the two together, or reverting to the newer version, as suggested.\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2018-11-08T22:39:45.312Z","reply_count":0,"reply_to_post_number":7,"quote_count":1,"incoming_link_count":2,"reads":43,"readers_count":42,"score":63.6,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":3}],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":37809,"name":"Maciej Borzecki","username":"mborzecki","avatar_template":"/user_avatar/forum.snapcraft.io/mborzecki/{size}/4382_2.png","created_at":"2018-11-15T08:04:39.883Z","cooked":"\u003cp\u003eThe docker command should probably read \u003ccode\u003edocker run --rm -v ...\u003c/code\u003e otherwise each run will leave a container behind.\u003c/p\u003e","post_number":9,"post_type":1,"updated_at":"2018-11-15T08:04:39.883Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":37,"readers_count":36,"score":32.4,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Maciej Borzecki","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1497,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":37813,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2018-11-15T09:27:57.865Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"mborzecki\" data-post=\"9\" data-topic=\"4158\" data-full=\"true\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/mborzecki/40/4382_2.png\" class=\"avatar\"\u003e mborzecki:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe docker command should probably read \u003ccode\u003edocker run --rm -v ...\u003c/code\u003e otherwise each run will leave a container behind.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eGreat point - thanks! I’ll add it to the command.\u003c/p\u003e","post_number":10,"post_type":1,"updated_at":"2018-11-15T09:27:57.865Z","reply_count":0,"reply_to_post_number":9,"quote_count":1,"incoming_link_count":4,"reads":40,"readers_count":39,"score":28.0,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":47731,"name":"pans","username":"pans","avatar_template":"/user_avatar/forum.snapcraft.io/pans/{size}/4740_2.png","created_at":"2019-04-28T11:31:37.145Z","cooked":"\u003cp\u003eThe current format of a snapcraft.yaml allows values for “title” and “license”. But when using the “snapcore/snapcraft” Docker image, I get:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIssues while validating snapcraft.yaml: Additional properties are not allowed (‘title’, ‘license’ were unexpected)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eAlso, it’s confusing to have seemingly two official Docker Hub organizations, both with seemingly outdated images:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://hub.docker.com/u/snapcraft\" rel=\"noopener nofollow ugc\"\u003ehttps://hub.docker.com/u/snapcraft\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://hub.docker.com/u/snapcore\" rel=\"noopener nofollow ugc\"\u003ehttps://hub.docker.com/u/snapcore\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe first one looks to be “more official” because of the Ubuntu logo and link to the website, but the official snapcraft docs link to the second one.\u003c/p\u003e","post_number":11,"post_type":1,"updated_at":"2019-04-28T11:31:37.145Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":4,"reads":36,"readers_count":35,"score":32.2,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"pans","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://hub.docker.com/u/snapcraft","internal":false,"reflection":false,"title":"Docker Hub","clicks":8},{"url":"https://hub.docker.com/u/snapcore","internal":false,"reflection":false,"title":"Docker Hub","clicks":6}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":4622,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":48159,"name":"Anatoli Babenia","username":"abitrolly","avatar_template":"/user_avatar/forum.snapcraft.io/abitrolly/{size}/4528_2.png","created_at":"2019-05-06T06:33:21.252Z","cooked":"\u003cp\u003e\u003ca class=\"mention\" href=\"/u/pans\"\u003e@pans\u003c/a\u003e validation error is because default image, which is \u003ccode\u003elatest\u003c/code\u003e, contains outdated 2.43.1 version of \u003ccode\u003esnapcraft\u003c/code\u003e. I filled \u003ca href=\"https://bugs.launchpad.net/snapcraft/+bug/1823519\" rel=\"noopener nofollow ugc\"\u003ehttps://bugs.launchpad.net/snapcraft/+bug/1823519\u003c/a\u003e to track this.\u003c/p\u003e","post_number":12,"post_type":1,"updated_at":"2019-05-06T06:33:21.252Z","reply_count":0,"reply_to_post_number":11,"quote_count":0,"incoming_link_count":1,"reads":34,"readers_count":33,"score":11.8,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Anatoli Babenia","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://bugs.launchpad.net/snapcraft/+bug/1823519","internal":false,"reflection":false,"title":"Bug #1823519 “Outdated DockerHub images” : Bugs : Snapcraft","clicks":5}],"read":true,"user_title":null,"reply_to_user":{"username":"pans","avatar_template":"/user_avatar/forum.snapcraft.io/pans/{size}/4740_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":2185,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":58257,"name":"Kenneth Loafman","username":"firstprime","avatar_template":"/user_avatar/forum.snapcraft.io/firstprime/{size}/4407_2.png","created_at":"2019-11-08T15:42:46.512Z","cooked":"\u003cp\u003eIs there a core18 version of Dockerfile?\u003cbr\u003e\nJust changing from xenial to bionic does not cut it.  It seems that line 12:\u003c/p\u003e\n\u003cp\u003eRUN curl -L $(curl -H ‘X-Ubuntu-Series: 16’ ‘\u003ca href=\"https://api.snapcraft.io/api/v1/snaps/details/core\" rel=\"noopener nofollow ugc\"\u003ehttps://api.snapcraft.io/api/v1/snaps/details/core\u003c/a\u003e’ | jq ‘.download_url’ -r) --output core.snap\u003c/p\u003e\n\u003cp\u003eshould reference Series: 18 and have a different core downloaded.\u003c/p\u003e\n\u003cp\u003eAny thoughts?\u003c/p\u003e","post_number":13,"post_type":1,"updated_at":"2019-11-08T15:42:46.512Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":29,"readers_count":28,"score":10.8,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Kenneth Loafman","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://api.snapcraft.io/api/v1/snaps/details/core","internal":false,"reflection":false,"clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":5867,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":58260,"name":"Kyle Fazzari","username":"kyrofa","avatar_template":"/user_avatar/forum.snapcraft.io/kyrofa/{size}/4384_2.png","created_at":"2019-11-08T16:19:49.558Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"firstprime\" data-post=\"13\" data-topic=\"4158\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/firstprime/40/4407_2.png\" class=\"avatar\"\u003e firstprime:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eshould reference Series: 18 and have a different core downloaded.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eYeah you’d think so, but no. I hit that a while back, too \u003cimg src=\"https://forum.snapcraft.io/images/emoji/emoji_one/stuck_out_tongue.png?v=9\" title=\":stuck_out_tongue:\" class=\"emoji\" alt=\":stuck_out_tongue:\"\u003e . Check \u003ca href=\"https://github.com/kyrofa/github-snap-builder-docker/blob/master/Dockerfile.core18\"\u003ethis core18 Dockerfile out\u003c/a\u003e.\u003c/p\u003e","post_number":14,"post_type":1,"updated_at":"2019-11-08T16:19:49.558Z","reply_count":1,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":0,"reads":29,"readers_count":28,"score":10.8,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Kyle Fazzari","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/kyrofa/github-snap-builder-docker/blob/master/Dockerfile.core18","internal":false,"reflection":false,"title":"github-snap-builder-docker/Dockerfile.core18 at master · kyrofa/github-snap-builder-docker · GitHub","clicks":9}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":17,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":58268,"name":"Kenneth Loafman","username":"firstprime","avatar_template":"/user_avatar/forum.snapcraft.io/firstprime/{size}/4407_2.png","created_at":"2019-11-08T21:28:15.314Z","cooked":"\u003cp\u003eThanks for the prompt reply!  I got it working on my Mac with a few other changes.  It’s slower than multipass to build, but at least I don’t have to shut down my Vbox instances to run it.\u003c/p\u003e","post_number":15,"post_type":1,"updated_at":"2019-11-08T21:28:15.314Z","reply_count":0,"reply_to_post_number":14,"quote_count":0,"incoming_link_count":1,"reads":32,"readers_count":31,"score":11.4,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Kenneth Loafman","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"kyrofa","avatar_template":"/user_avatar/forum.snapcraft.io/kyrofa/{size}/4384_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":5867,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":84311,"name":"","username":"NeroBurner","avatar_template":"/user_avatar/forum.snapcraft.io/neroburner/{size}/3730_2.png","created_at":"2020-12-21T12:50:17.382Z","cooked":"\u003cp\u003eOn \u003ca href=\"https://snapcraft.io/docs/build-on-docker\" rel=\"noopener nofollow ugc\"\u003ehttps://snapcraft.io/docs/build-on-docker\u003c/a\u003e the example Dockerfile for building for \u003ccode\u003ecore18\u003c/code\u003e first references \u003ccode\u003eubuntu:bionic\u003c/code\u003e, but then in the middle is based on \u003ccode\u003eubuntu:xenial\u003c/code\u003e before the copy commands\u003c/p\u003e\n\u003cp\u003eThe script postet by \u003ca class=\"mention\" href=\"/u/kyrofa\"\u003e@kyrofa\u003c/a\u003e is more like I expected. This script additionally downloads the \u003ccode\u003ecore18\u003c/code\u003e snap, which the documentation does not do.\u003c/p\u003e\n\u003cp\u003eI propose the following changes to the documentation\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-diff\"\u003eFROM ubuntu:bionic as builder\n\n# Grab dependencies\nRUN apt-get update\nRUN apt-get dist-upgrade --yes\nRUN apt-get install --yes \\\n      curl \\\n      jq \\\n      squashfs-tools\n\n# Grab the core snap from the stable channel and unpack it in the proper place\nRUN curl -L $(curl -H 'X-Ubuntu-Series: 16' 'https://api.snapcraft.io/api/v1/snaps/details/core' | jq '.download_url' -r) --output core.snap\nRUN mkdir -p /snap/core\nRUN unsquashfs -d /snap/core/current core.snap\n\n+# Grab the core18 snap from the stable channel and unpack it in the proper place\n+RUN curl -L $(curl -H 'X-Ubuntu-Series: 16' 'https://api.snapcraft.io/api/v1/snaps/details/core18' | jq '.download_url' -r) --output core18.snap\n+RUN mkdir -p /snap/core18\n+RUN unsquashfs -d /snap/core18/current core18.snap\n+\n# Grab the snapcraft snap from the stable channel and unpack it in the proper place\nRUN curl -L $(curl -H 'X-Ubuntu-Series: 16' 'https://api.snapcraft.io/api/v1/snaps/details/snapcraft?channel=stable' | jq '.download_url' -r) --output snapcraft.snap\nRUN mkdir -p /snap/snapcraft\nRUN unsquashfs -d /snap/snapcraft/current snapcraft.snap\n\n# Create a snapcraft runner (TODO: move version detection to the core of snapcraft)\nRUN mkdir -p /snap/bin\nRUN echo \"#!/bin/sh\" \u0026gt; /snap/bin/snapcraft\nRUN snap_version=\"$(awk '/^version:/{print $2}' /snap/snapcraft/current/meta/snap.yaml)\" \u0026amp;\u0026amp; echo \"export SNAP_VERSION=\\\"$snap_version\\\"\" \u0026gt;\u0026gt; /snap/bin/snapcraft\nRUN echo 'exec \"$SNAP/usr/bin/python3\" \"$SNAP/bin/snapcraft\" \"$@\"' \u0026gt;\u0026gt; /snap/bin/snapcraft\nRUN chmod +x /snap/bin/snapcraft\n\n# Multi-stage build, only need the snaps from the builder. Copy them one at a\n# time so they can be cached.\n-FROM ubuntu:xenial\n+FROM ubuntu:bionic\nCOPY --from=builder /snap/core /snap/core\n+COPY --from=builder /snap/core18 /snap/core18\nCOPY --from=builder /snap/snapcraft /snap/snapcraft\nCOPY --from=builder /snap/bin/snapcraft /snap/bin/snapcraft\n\n# Generate locale\nRUN apt-get update \u0026amp;\u0026amp; apt-get dist-upgrade --yes \u0026amp;\u0026amp; apt-get install --yes sudo locales \u0026amp;\u0026amp; locale-gen en_US.UTF-8\n\n# Set the proper environment\nENV LANG=\"en_US.UTF-8\"\nENV LANGUAGE=\"en_US:en\"\nENV LC_ALL=\"en_US.UTF-8\"\nENV PATH=\"/snap/bin:$PATH\"\nENV SNAP=\"/snap/snapcraft/current\"\nENV SNAP_NAME=\"snapcraft\"\nENV SNAP_ARCH=\"amd64\"\n\u003c/code\u003e\u003c/pre\u003e","post_number":16,"post_type":1,"updated_at":"2020-12-21T12:50:17.382Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":28,"readers_count":27,"score":60.6,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://snapcraft.io/docs/build-on-docker","internal":false,"reflection":false,"title":"Build on Docker | Snapcraft documentation","clicks":2}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":4631,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":84928,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2021-01-06T12:15:21.736Z","cooked":"\u003cp\u003eThank you for proposing those changes!  I’ve merged them into the documented script.\u003c/p\u003e\n\u003cp\u003eI also added snapd as a dependency because, while testing, the image build failed with \u003cem\u003eA tool snapcraft depends on could not be found: ‘snap’.\u003c/em\u003e I believe snapcraft now requires snapd externally.\u003c/p\u003e","post_number":17,"post_type":1,"updated_at":"2021-01-06T12:15:21.736Z","reply_count":0,"reply_to_post_number":16,"quote_count":0,"incoming_link_count":0,"reads":25,"readers_count":24,"score":20.0,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"NeroBurner","avatar_template":"/user_avatar/forum.snapcraft.io/neroburner/{size}/3730_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":101612,"name":"Colin Watson","username":"cjwatson","avatar_template":"/user_avatar/forum.snapcraft.io/cjwatson/{size}/4388_2.png","created_at":"2021-11-02T21:40:47.241Z","cooked":"\u003cp\u003eAfter some internal discussion, I updated the sample \u003ccode\u003eDockerfile\u003c/code\u003e to add \u003ccode\u003eSnap-CDN: none\u003c/code\u003e HTTP headers in order to work properly in the Launchpad build farm.\u003c/p\u003e","post_number":18,"post_type":1,"updated_at":"2021-11-02T21:40:47.241Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":22,"readers_count":21,"score":49.4,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Colin Watson","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":74,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":113423,"name":"Brecht","username":"BrechtNr","avatar_template":"/letter_avatar/brechtnr/{size}/5_6d6f4cde2641c35611d5cac2fb97c77e.png","created_at":"2022-08-30T15:00:16.507Z","cooked":"\u003cp\u003eHi \u003ca class=\"mention\" href=\"/u/degville\"\u003e@degville\u003c/a\u003e \u0026amp; others,\u003c/p\u003e\n\u003cp\u003eThanks for this helpful thread \u0026amp; info.\nI tried out the build in Docker and that absolutely works fine.\nHowever, the point raised by \u003ca class=\"mention\" href=\"/u/kyrofa\"\u003e@kyrofa\u003c/a\u003e is still valid: There is a prebuilt Docker image on Dockerhub from the organisation “snapcraft”, which contains images that are hopelessly outdated:\n\u003ca href=\"https://hub.docker.com/u/snapcraft\" rel=\"noopener nofollow ugc\"\u003esnapcraft’s Profile | Docker Hub\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eAnd there is a Dockerhub org “snapcore” which does seem to contain an up to date Docker image that matches the current Dockerfile from the snapcraft repo: \u003ca href=\"https://hub.docker.com/u/snapcore\" rel=\"noopener nofollow ugc\"\u003esnapcore’s Profile | Docker Hub\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIs there a way we could improve this? Could we link from these docs directly to the correct Dockerhub? That would help save people wanting to  use Docker some time.\u003c/p\u003e\n\u003cp\u003eKind regards,\u003c/p\u003e\n\u003cp\u003eBrecht\u003c/p\u003e","post_number":19,"post_type":1,"updated_at":"2022-08-30T15:00:16.507Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":21,"readers_count":20,"score":9.2,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Brecht","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://hub.docker.com/u/snapcraft","internal":false,"reflection":false,"title":"Docker Hub","clicks":0},{"url":"https://hub.docker.com/u/snapcore","internal":false,"reflection":false,"title":"Docker Hub","clicks":0}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":12792,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":113428,"name":"Kyle Fazzari","username":"kyrofa","avatar_template":"/user_avatar/forum.snapcraft.io/kyrofa/{size}/4384_2.png","created_at":"2022-08-30T16:24:21.147Z","cooked":"\u003cp\u003eFYI, an anecdote, but I’ve had to move away from docker entirely because snapcraft’s core plugins are making wider use of \u003ccode\u003ebuild-snaps\u003c/code\u003e, which don’t work on docker. Tread carefully.\u003c/p\u003e","post_number":20,"post_type":1,"updated_at":"2022-08-30T16:24:21.147Z","reply_count":2,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":21,"readers_count":20,"score":19.2,"yours":false,"topic_id":4158,"topic_slug":"build-on-docker","display_username":"Kyle Fazzari","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":17,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[20689,20697,20703,20704,33371,36734,37362,37363,37809,37813,47731,48159,58257,58260,58268,84311,84928,101612,113423,113428,113437,113438,113443,113444,113446,113453,114047,114052,114100,114101,114104,114112,118801,118804,118839,118841]},"timeline_lookup":[[1,1939],[5,1740],[6,1689],[7,1680],[9,1674],[11,1510],[12,1502],[13,1315],[16,907],[17,891],[18,590],[19,289],[27,274],[29,273],[33,143],[35,142]],"tags":[],"id":4158,"title":"Build on Docker","fancy_title":"Build on Docker","posts_count":36,"created_at":"2018-02-22T23:59:02.102Z","views":13762,"reply_count":17,"like_count":15,"last_posted_at":"2023-01-24T19:04:05.134Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"build-on-docker","category_id":15,"word_count":3898,"deleted_at":null,"user_id":1044,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_4158","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":36,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"topic_timer":null,"message_bus_last_id":0,"participant_count":16,"show_read_indicator":false,"thumbnails":null,"details":{"notification_level":1,"participants":[{"id":286,"username":"lucyllewy","name":"Lucy Llewellyn","avatar_template":"/user_avatar/forum.snapcraft.io/lucyllewy/{size}/9782_2.png","post_count":6,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":12792,"username":"BrechtNr","name":"Brecht","avatar_template":"/letter_avatar/brechtnr/{size}/5_6d6f4cde2641c35611d5cac2fb97c77e.png","post_count":6,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":17,"username":"kyrofa","name":"Kyle Fazzari","avatar_template":"/user_avatar/forum.snapcraft.io/kyrofa/{size}/4384_2.png","post_count":6,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","post_count":5,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":5867,"username":"firstprime","name":"Kenneth Loafman","avatar_template":"/user_avatar/forum.snapcraft.io/firstprime/{size}/4407_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1814,"username":"bsutton","name":"Brett Sutton","avatar_template":"/user_avatar/forum.snapcraft.io/bsutton/{size}/4941_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":2185,"username":"abitrolly","name":"Anatoli Babenia","avatar_template":"/user_avatar/forum.snapcraft.io/abitrolly/{size}/4528_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":2438,"username":"ijohnson","name":"Ian Johnson","avatar_template":"/user_avatar/forum.snapcraft.io/ijohnson/{size}/2091_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":3513,"username":"igorkupczynski","name":"Igor Kupczyński","avatar_template":"/letter_avatar/igorkupczynski/{size}/5_6d6f4cde2641c35611d5cac2fb97c77e.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":4622,"username":"pans","name":"pans","avatar_template":"/user_avatar/forum.snapcraft.io/pans/{size}/4740_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":4631,"username":"NeroBurner","name":"","avatar_template":"/user_avatar/forum.snapcraft.io/neroburner/{size}/3730_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":13932,"username":"hectorcao","name":"Hector Cao","avatar_template":"/user_avatar/forum.snapcraft.io/hectorcao/{size}/9518_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":74,"username":"cjwatson","name":"Colin Watson","avatar_template":"/user_avatar/forum.snapcraft.io/cjwatson/{size}/4388_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1044,"username":"wiki","name":"Wiki Content","avatar_template":"/user_avatar/forum.snapcraft.io/wiki/{size}/425_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1417,"username":"Lin-Buo-Ren","name":"林博仁(Buo-ren, Lin)","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1497,"username":"mborzecki","name":"Maciej Borzecki","avatar_template":"/user_avatar/forum.snapcraft.io/mborzecki/{size}/4382_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null}],"created_by":{"id":1044,"username":"wiki","name":"Wiki Content","avatar_template":"/user_avatar/forum.snapcraft.io/wiki/{size}/425_2.png"},"last_poster":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"},"links":[{"url":"https://docs.snapcraft.io/building-the-snap-on-docker/6757","title":"Building the snap on Docker - Documentation for snaps: Universal Linux packages","internal":false,"attachment":false,"reflection":false,"clicks":35,"user_id":2438,"domain":"docs.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://hub.docker.com/r/snapcore/snapcraft/","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":20,"user_id":17,"domain":"hub.docker.com","root_domain":"docker.com"},{"url":"https://forum.snapcraft.io/t/building-the-snap-on-docker/6757","title":"Building the snap on Docker","internal":true,"attachment":false,"reflection":false,"clicks":18,"user_id":1417,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/creating-docker-images-for-snapcraft/11739","title":"Creating docker images for snapcraft","internal":true,"attachment":false,"reflection":false,"clicks":17,"user_id":1044,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/kyrofa/github-snap-builder-docker/blob/master/Dockerfile.core18","title":"github-snap-builder-docker/Dockerfile.core18 at master · kyrofa/github-snap-builder-docker · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":9,"user_id":17,"domain":"github.com","root_domain":"github.com"},{"url":"https://hub.docker.com/u/snapcraft","title":"Docker Hub","internal":false,"attachment":false,"reflection":false,"clicks":8,"user_id":4622,"domain":"hub.docker.com","root_domain":"docker.com"},{"url":"https://forum.snapcraft.io/t/building-the-snap-on-docker/6757/2","title":"Building the snap on Docker","internal":true,"attachment":false,"reflection":false,"clicks":7,"user_id":3513,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/snapcore/snapcraft/tree/master/docker","title":"snapcraft/docker at master · snapcore/snapcraft · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":7,"user_id":1044,"domain":"github.com","root_domain":"github.com"},{"url":"https://hub.docker.com/u/snapcore","title":"Docker Hub","internal":false,"attachment":false,"reflection":false,"clicks":6,"user_id":4622,"domain":"hub.docker.com","root_domain":"docker.com"},{"url":"https://bugs.launchpad.net/snapcraft/+bug/1823519","title":"Bug #1823519 “Outdated DockerHub images” : Bugs : Snapcraft","internal":false,"attachment":false,"reflection":false,"clicks":5,"user_id":2185,"domain":"bugs.launchpad.net","root_domain":"launchpad.net"},{"url":"https://hub.docker.com/r/diddledan/snapcraft","title":"Docker Hub","internal":false,"attachment":false,"reflection":false,"clicks":4,"user_id":286,"domain":"hub.docker.com","root_domain":"docker.com"},{"url":"https://forum.snapcraft.io/t/base-snaps/11198","title":"Base snaps","internal":true,"attachment":false,"reflection":false,"clicks":3,"user_id":1044,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/reasoning-behind-the-move-to-multipass/9648/5","title":"Reasoning behind the move to multipass","internal":true,"attachment":false,"reflection":false,"clicks":3,"user_id":12792,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/releasing-your-app/6795","title":"Releasing your app","internal":true,"attachment":false,"reflection":false,"clicks":3,"user_id":1044,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://snapcraft.io/docs/build-on-docker","title":"Build on Docker | Snapcraft documentation","internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":4631,"domain":"snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/diddlesnaps/snapcraft-container/pull/21","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":286,"domain":"github.com","root_domain":"github.com"},{"url":"https://forum.snapcraft.io/t/creating-a-snap/6799","title":"Creating a snap","internal":true,"attachment":false,"reflection":false,"clicks":2,"user_id":1044,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://snapcraft.io/store","title":"Install Linux apps using the Snap Store | Snapcraft","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":1044,"domain":"snapcraft.io","root_domain":"snapcraft.io"},{"url":"http://hub.docker.com/r/diddledani/snapcraft","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":286,"domain":"hub.docker.com","root_domain":"docker.com"},{"url":"https://community.ubuntu.com/t/installing-multipass-on-linux/8328","title":"Installing Multipass on Linux - Documentation - Ubuntu Community Hub","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":1044,"domain":"community.ubuntu.com","root_domain":"ubuntu.com"},{"url":"https://docs.docker.com/install/","title":"About Docker CE | Docker Documentation","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":1044,"domain":"docs.docker.com","root_domain":"docker.com"},{"url":"https://forum.snapcraft.io/t/building-the-snap/6800","title":"Building the snap","internal":true,"attachment":false,"reflection":true,"clicks":1,"user_id":12,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/release-notes-snapcraft-3-0/10704","title":"Release notes: Snapcraft 3.0","internal":true,"attachment":false,"reflection":false,"clicks":1,"user_id":1044,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/diddlesnaps/snapcraft-multiarch-action","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":286,"domain":"github.com","root_domain":"github.com"},{"url":"http://docs.snapcraft.io","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":2438,"domain":"docs.snapcraft.io","root_domain":"snapcraft.io"}]}}