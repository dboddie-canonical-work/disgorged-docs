{"post_stream":{"posts":[{"id":29242,"name":"James Henstridge","username":"jamesh","avatar_template":"/user_avatar/forum.snapcraft.io/jamesh/{size}/3947_2.png","created_at":"2018-07-04T09:23:15.399Z","cooked":"\u003cp\u003eA common request is to \u003ca href=\"https://forum.snapcraft.io/t/use-the-system-gtk-theme/496\"\u003eallow applications to follow the GTK theme of the host system desktop\u003c/a\u003e.  While we don’t yet have all the infrastructure in place for arbitrary themes, we do now have one that will automatically handle the default themes of common Linux distributions.  This will be sufficient for applications based on GTK 3, and Qt 5 apps using the \u003ccode\u003elibqgtk3.so\u003c/code\u003e platform theme.\u003c/p\u003e\n\u003cp\u003eI’ve put together a short Snapcraft project that demonstrates how everything fits together:\u003c/p\u003e\n\u003caside class=\"onebox githubgist\"\u003e\n  \u003cheader class=\"source\"\u003e\n      \u003ca href=\"https://gist.github.com/jhenstridge/7f8c6d43bf21a42579e18d339be7a4fb\" target=\"_blank\" rel=\"noopener nofollow ugc\"\u003egist.github.com\u003c/a\u003e\n  \u003c/header\u003e\n  \u003carticle class=\"onebox-body\"\u003e\n    \u003ch4\u003e\u003ca href=\"https://gist.github.com/jhenstridge/7f8c6d43bf21a42579e18d339be7a4fb\" target=\"_blank\" rel=\"noopener nofollow ugc\"\u003ehttps://gist.github.com/jhenstridge/7f8c6d43bf21a42579e18d339be7a4fb\u003c/a\u003e\u003c/h4\u003e\n\u003ch5\u003esnapcraft.yaml\u003c/h5\u003e\n\u003cpre\u003e\u003ccode class=\"YAML\"\u003ename: gtk3-demo\nversion: '0.1'\nsummary: A demonstration application for features of GTK\ndescription: |\n  This snap contains the gtk3-demo application, using theme data\n  provided by one or more external snaps.\n\ngrade: devel # must be 'stable' to release into candidate/stable channels\nconfinement: strict\n\u003c/code\u003e\u003c/pre\u003e\nThis file has been truncated. \u003ca href=\"https://gist.github.com/jhenstridge/7f8c6d43bf21a42579e18d339be7a4fb\" target=\"_blank\" rel=\"noopener nofollow ugc\"\u003eshow original\u003c/a\u003e\n\n\u003cp\u003e\n\u003c/p\u003e\n\n  \u003c/article\u003e\n  \u003cdiv class=\"onebox-metadata\"\u003e\n    \n    \n  \u003c/div\u003e\n  \u003cdiv style=\"clear: both\"\u003e\u003c/div\u003e\n\u003c/aside\u003e\n\n\u003cp\u003eNow for a breakdown of the important parts of this project:\u003c/p\u003e\n\u003ch2\u003eContent interface plugs\u003c/h2\u003e\n\u003cp\u003eThe theme data is made available through a set of content interface plugs.  This can be achieved by adding the following boilerplate to the \u003ccode\u003eplugs:\u003c/code\u003e stanza of the project:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eplugs:\n  gtk-3-themes:\n    interface: content\n    target: $SNAP/share/themes\n    default-provider: gtk-common-themes\n  icon-themes:\n    interface: content\n    target: $SNAP/share/icons\n    default-provider: gtk-common-themes\n  sound-themes:\n    interface: content\n    target: $SNAP/share/sounds\n    default-provider: gtk-common-themes\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis will cause various pieces of theme data to be mounted under \u003ccode\u003e$SNAP/share\u003c/code\u003e, and to source it from the \u003ccode\u003egtk-common-themes\u003c/code\u003e snap by default.  As with other content interfaces, snapd will use the \u003ccode\u003edefault-provider\u003c/code\u003e line to install the \u003ccode\u003egtk-common-themes\u003c/code\u003e snap if it isn’t present.\u003c/p\u003e\n\u003cp\u003eIn addition to the plug definitions, I’ve also made sure one of the parts will create the directories used as content interface mount points and ensure they are primed.\u003c/p\u003e\n\u003cp\u003eIn the future, we hope to remove the need for much of this boilerplate through the use of \u003ca href=\"https://forum.snapcraft.io/t/proposal-templates/6019\"\u003eSnapcraft templates\u003c/a\u003e.\u003c/p\u003e\n\u003ch2\u003eAllowing GTK to detect the selected system theme\u003c/h2\u003e\n\u003cp\u003eThe way GTK determines what the current theme is depends on the windowing system in use:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOn an X11 session, the \u003ca href=\"https://specifications.freedesktop.org/xsettings-spec/xsettings-latest.html\" rel=\"noopener nofollow ugc\"\u003eXSETTINGS specification\u003c/a\u003e is used.  This only involves a set of X11 calls, so plugging the \u003ccode\u003ex11\u003c/code\u003e interface is sufficient.\u003c/li\u003e\n\u003cli\u003eOn a Wayland session, GTK instead uses the \u003ccode\u003eGSettings\u003c/code\u003e API to read the users preferences directly, bypassing the display server.  So plugging the \u003ccode\u003egsettings\u003c/code\u003e interface is also necessary.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePutting that all together, most apps should plug at least the following:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e  - desktop\n  - gsettings\n  - wayland\n  - x11\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eHow do I know if everything is working?\u003c/h2\u003e\n\u003cp\u003eOther than changing your desktop’s current theme, GTK lets you use the \u003ccode\u003eGTK_THEME\u003c/code\u003e environment variable to override the default theme.  So using our example project, I can run the app using a theme not currently installed on the host system:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ GTK_THEME=Arc-Dark gtk3-demo\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou can also inspect the available themes within the confinement sandbox:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ snap run --shell gtk3-demo\n\nTo run a command as administrator (user \"root\"), use \"sudo \u0026lt;command\u0026gt;\".\nSee \"man sudo_root\" for details.\n\n$ ls $SNAP/share/themes\nAdwaita       Ambiance\tArc-Dark    Communitheme  EvoPop-Azure\tRadiance\nAdwaita-dark  Arc\tArc-Darker  EvoPop\t  HighContrast\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWhat about \u003cem\u003eun\u003c/em\u003ecommon themes?\u003c/h2\u003e\n\u003cp\u003eWe don’t currently have a system in place to automatically install third party theme snaps yet, but that should come in future.  The way we’ve used the content interface is intended to allow third party themes to \u003cem\u003esupplement\u003c/em\u003e those provided by \u003ccode\u003egtk-common-themes\u003c/code\u003e rather than \u003cem\u003ereplacing\u003c/em\u003e those themes.  So a GTK theme that re-uses a common icon theme doesn’t need to repackage all the icons.\u003c/p\u003e\n\u003cp\u003eIf a third party snap also provides a \u003ccode\u003egtk-3-themes\u003c/code\u003e slot, it can be connected to applications simultaneously with \u003ccode\u003egtk-common-themes\u003c/code\u003e.  The \u003ccode\u003egtk-common-themes\u003c/code\u003e snap can also be used as a template for your own third party theme snaps:\u003c/p\u003e\n\u003caside class=\"onebox allowlistedgeneric\"\u003e\n  \u003cheader class=\"source\"\u003e\n      \u003cimg src=\"https://github.githubassets.com/favicons/favicon.svg\" class=\"site-icon\" width=\"32\" height=\"32\"\u003e\n      \u003ca href=\"https://github.com/snapcrafters/gtk-common-themes\" target=\"_blank\" rel=\"noopener nofollow ugc\"\u003eGitHub\u003c/a\u003e\n  \u003c/header\u003e\n  \u003carticle class=\"onebox-body\"\u003e\n    \u003cimg src=\"https://avatars.githubusercontent.com/u/29598503?s=400\u0026amp;v=4\" class=\"thumbnail onebox-avatar\" width=\"400\" height=\"400\"\u003e\n\n\u003ch3\u003e\u003ca href=\"https://github.com/snapcrafters/gtk-common-themes\" target=\"_blank\" rel=\"noopener nofollow ugc\"\u003esnapcrafters/gtk-common-themes\u003c/a\u003e\u003c/h3\u003e\n\n\u003cp\u003eContribute to snapcrafters/gtk-common-themes development by creating an account on GitHub.\u003c/p\u003e\n\n\n  \u003c/article\u003e\n  \u003cdiv class=\"onebox-metadata\"\u003e\n    \n    \n  \u003c/div\u003e\n  \u003cdiv style=\"clear: both\"\u003e\u003c/div\u003e\n\u003c/aside\u003e\n\n\u003cp\u003eTo test these additional snaps while we’re working on an automatic install solution, you will need to manually install the theme snap and then manually connect the interfaces to each application snap.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2020-02-21T19:42:03.041Z","reply_count":2,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":11864,"reads":162,"readers_count":161,"score":59558.4,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"James Henstridge","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":5,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/snapcrafters/gtk-common-themes","internal":false,"reflection":false,"title":"GitHub - snapcrafters/gtk-common-themes","clicks":360},{"url":"https://gist.github.com/jhenstridge/7f8c6d43bf21a42579e18d339be7a4fb","internal":false,"reflection":false,"title":"Using the gtk-common-themes snap · GitHub","clicks":332},{"url":"https://forum.snapcraft.io/t/use-the-system-gtk-theme/496","internal":true,"reflection":false,"title":"Use the system gtk theme","clicks":187},{"url":"https://specifications.freedesktop.org/xsettings-spec/xsettings-latest.html","internal":false,"reflection":false,"clicks":67},{"url":"https://forum.snapcraft.io/t/proposal-templates/6019","internal":true,"reflection":false,"title":"Proposal: templates","clicks":43},{"url":"https://forum.snapcraft.io/t/use-the-system-gtk-theme/496/47","internal":true,"reflection":true,"title":"Use the system gtk theme","clicks":21},{"url":"https://forum.snapcraft.io/t/qt-apps-and-gtk-themes-an-investigation-with-partial-success/10513/4","internal":true,"reflection":true,"title":"Qt Apps and GTK Themes, an investigation with partial success","clicks":12},{"url":"https://forum.snapcraft.io/t/gtk3-app-python-theme-and-font-support/9129/2","internal":true,"reflection":true,"title":"Gtk3 App Python theme and font support","clicks":9},{"url":"https://forum.snapcraft.io/t/supporting-desktop-themes-via-the-content-interface/4122/11","internal":true,"reflection":true,"title":"Supporting desktop themes via the content interface","clicks":5},{"url":"https://forum.snapcraft.io/t/reducing-the-size-of-desktop-snaps/17280","internal":true,"reflection":true,"title":"Reducing the size of desktop snaps","clicks":1},{"url":"https://forum.snapcraft.io/t/very-ugly-cursor-for-spotify-and-kde-snaps/17118/2","internal":true,"reflection":true,"title":"Very ugly cursor for Spotify and KDE snaps","clicks":0},{"url":"https://forum.snapcraft.io/t/legacy-desktop-app-support-gtk3-applications-without-extensions/13506","internal":true,"reflection":true,"title":"[legacy] Desktop App Support - GTK3 applications without extensions","clicks":0},{"url":"https://forum.snapcraft.io/t/missing-desktop-file-and-executable/12608/8","internal":true,"reflection":true,"title":"Missing desktop file and executable","clicks":0},{"url":"https://forum.snapcraft.io/t/gnome-calculator-does-not-respect-shell-theme/9454/2","internal":true,"reflection":true,"title":"Gnome-calculator does not respect shell theme","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":10}],"moderator":false,"admin":false,"staff":false,"user_id":393,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":true,"last_wiki_edit":"2020-02-21T19:42:03.067Z","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29267,"name":"Stuart Langridge","username":"sil","avatar_template":"/user_avatar/forum.snapcraft.io/sil/{size}/182_2.png","created_at":"2018-07-04T14:12:53.801Z","cooked":"\u003cp\u003eThis looks like cool stuff. A question: you say “this can be achieved by adding the following boilerplate to the plugs: stanza of the project”, but surely this should be in there by default? If a developer \u003cem\u003ewants\u003c/em\u003e their app to look inconsistent then that seems like something worth adding configuration for; an app should surely not have to opt in to looking normal? Possibly I’ve misunderstood this, though!\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2018-07-04T14:12:53.801Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":103,"reads":125,"readers_count":124,"score":620.0,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Stuart Langridge","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":5}],"moderator":false,"admin":false,"staff":false,"user_id":764,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29354,"name":"Merlijn Sebrechts","username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png","created_at":"2018-07-05T17:14:26.035Z","cooked":"\u003cp\u003eThis doesn’t seem to be working with Mattermost. However, when I run \u003ccode\u003esnap run --shell mattermost-desktop\u003c/code\u003e, I see the themes are mounted correctly in \u003ccode\u003eshare/*\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eJust to clarify; does this also work with GTK2 applications or only GTK3 applications?\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2018-07-05T22:29:50.270Z","reply_count":2,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":6,"reads":112,"readers_count":111,"score":62.4,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Merlijn Sebrechts","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":3,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1418,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29360,"name":"Lucy Llewellyn","username":"lucyllewy","avatar_template":"/user_avatar/forum.snapcraft.io/lucyllewy/{size}/9782_2.png","created_at":"2018-07-05T20:50:21.730Z","cooked":"\u003cp\u003eI think, but am ready to hold my hand up to the fact that it’s a guesstimate, that the sound and icon themes will work cross-toolkit but the themes will only work with gtk3 because gtk2 needs some library support in addition to styling rules. GTK3 doesn’t have the library requirement for it’s themes, so they’re easier to move between builds.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2018-07-05T20:50:21.730Z","reply_count":0,"reply_to_post_number":3,"quote_count":0,"incoming_link_count":8,"reads":103,"readers_count":102,"score":75.6,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Lucy Llewellyn","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","reply_to_user":{"username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":286,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29362,"name":"Merlijn Sebrechts","username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png","created_at":"2018-07-05T21:50:06.619Z","cooked":"\u003cp\u003e\u003ca class=\"mention\" href=\"/u/jamesh\"\u003e@jamesh\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eCan you turn your post into a wiki? I’m experimenting with getting GTK2 theming working and I’d like to add it to your post.\u003c/p\u003e\n\u003cp\u003eAlso, why do you use \u003ccode\u003e$SNAP/share\u003c/code\u003e instead of \u003ccode\u003e$SNAP/usr/share\u003c/code\u003e? A lot more stuff magically works when you use \u003ccode\u003e$SNAP/usr/share\u003c/code\u003e, I’m still trying to find why but I think it’s because that’s where the desktop helpers expect the themes to be.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2018-07-05T21:50:06.619Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":25,"reads":100,"readers_count":99,"score":165.0,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Merlijn Sebrechts","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1418,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29365,"name":"Merlijn Sebrechts","username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png","created_at":"2018-07-05T22:39:11.392Z","cooked":"\u003cp\u003eI got it working for the Communitheme GTK2 theme. It should work for most other GTK2 themes too.\u003c/p\u003e\n\u003ch1\u003eHow to use \u003ccode\u003egtk-common-themes\u003c/code\u003e with GTK2 app?\u003c/h1\u003e\n\u003cp\u003eIt’s quite simple if you’re already using the \u003ca href=\"https://github.com/ubuntu/snapcraft-desktop-helpers/\" rel=\"noopener nofollow ugc\"\u003e\u003ccode\u003edesktop-helpers\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eAdd the GTK2 theme engine to \u003ccode\u003estage-packages\u003c/code\u003e. In the case of communitheme, this is \u003ccode\u003egtk2-engines-pixbuf\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eAdd the plugs with target \u003cstrong\u003e\u003ccode\u003e$SNAP/usr/share\u003c/code\u003e\u003c/strong\u003e instead of \u003ccode\u003e$SNAP/share\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eFor a full working example of an electron app with GTK2 using desktop helpers, see the \u003ca href=\"https://github.com/snapcrafters/mattermost-desktop/blob/master/snap/snapcraft.yaml\" rel=\"noopener nofollow ugc\"\u003eMattermost \u003ccode\u003esnapcraft.yaml\u003c/code\u003e file\u003c/a\u003e.\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2018-07-05T23:10:46.591Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":86,"reads":98,"readers_count":97,"score":479.6,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Merlijn Sebrechts","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/ubuntu/snapcraft-desktop-helpers/","internal":false,"reflection":false,"title":"GitHub - ubuntu/snapcraft-desktop-helpers: Various launchers for snapcraft wiki parts","clicks":47},{"url":"https://github.com/snapcrafters/mattermost-desktop/blob/master/snap/snapcraft.yaml","internal":false,"reflection":false,"title":"mattermost-desktop/snapcraft.yaml at master · snapcrafters/mattermost-desktop · GitHub","clicks":34}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":2}],"moderator":false,"admin":false,"staff":false,"user_id":1418,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29368,"name":"Merlijn Sebrechts","username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png","created_at":"2018-07-05T23:09:10.346Z","cooked":"\u003cp\u003eNote that there is still an issue somewhere. The first time users refresh to a snap using \u003ccode\u003egtk-common-themes\u003c/code\u003e, they get the following error message:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eerror: cannot perform the following tasks:\n- Download snap \"gtk-common-themes\" (319) from channel \"stable\" (rename /var/lib/snapd/snaps/gtk-common-themes_319.snap.partial /var/lib/snapd/snaps/gtk-common-themes_319.snap: no such file or directory)\n- Download snap \"gtk-common-themes\" (319) from channel \"stable\" (rename /var/lib/snapd/snaps/gtk-common-themes_319.snap.partial /var/lib/snapd/snaps/gtk-common-themes_319.snap: no such file or directory)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eDespite this error message, the refresh seems to succeed. However, some users are reporting that \u003ccode\u003egtk-common-themes\u003c/code\u003e is still not installed: \u003ca href=\"https://forum.snapcraft.io/t/auto-connect-doesnt-seem-to-work-on-refresh/6198\" class=\"inline-onebox\"\u003eAuto-connect doesn't seem to work on refresh\u003c/a\u003e and the original issue: \u003ca href=\"https://github.com/ubuntu/gtk-communitheme/issues/354#issuecomment-401633857\" rel=\"noopener nofollow ugc\"\u003ehttps://github.com/ubuntu/gtk-communitheme/issues/354#issuecomment-401633857\u003c/a\u003e\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2018-07-05T23:09:10.346Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":15,"reads":97,"readers_count":96,"score":94.4,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Merlijn Sebrechts","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/ubuntu/gtk-communitheme/issues/354#issuecomment-401633857","internal":false,"reflection":false,"title":"None of the default provided snaps in 18.04 work properly with the snap community theme · Issue #354 · ubuntu/gtk-communitheme · GitHub","clicks":6},{"url":"https://forum.snapcraft.io/t/auto-connect-doesnt-seem-to-work-on-refresh/6198","internal":true,"reflection":false,"title":"Auto-connect doesn't seem to work on refresh","clicks":1}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1418,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29370,"name":"Ken VanDine","username":"kenvandine","avatar_template":"/user_avatar/forum.snapcraft.io/kenvandine/{size}/4387_2.png","created_at":"2018-07-05T23:54:11.000Z","cooked":"\u003cp\u003eActually the desktop helpers are looking for them in $SNAP/data-dir\u003c/p\u003e\n\u003cp\u003eThis is because the mount fails when the directory already exists.  For an example see:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://bazaar.launchpad.net/~ubuntu-desktop/quadrapassel/snap/view/head:/snapcraft.yaml#L26\" rel=\"noopener nofollow ugc\"\u003ehttps://bazaar.launchpad.net/~ubuntu-desktop/quadrapassel/snap/view/head:/snapcraft.yaml#L26\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eUltimately we don’t want everyone to put this into their snaps, we want developers to use the upcoming template feature in snapcraft to prevent lots of boiler plate yaml that ends up being hard to maintain.\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2018-07-05T23:54:39.545Z","reply_count":1,"reply_to_post_number":5,"quote_count":0,"incoming_link_count":231,"reads":93,"readers_count":92,"score":1203.6,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Ken VanDine","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://bazaar.launchpad.net/~ubuntu-desktop/quadrapassel/snap/view/head:/snapcraft.yaml#L26","internal":false,"reflection":false,"title":"~ubuntu-desktop/quadrapassel/snap : contents of snapcraft.yaml at revision 23","clicks":27},{"url":"https://forum.snapcraft.io/t/gtk-common-themes-plug/11972/2","internal":true,"reflection":true,"title":"Gtk-common-themes plug","clicks":0}],"read":true,"user_title":"policy-reviewers","title_is_group":false,"reply_to_user":{"username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":2}],"moderator":false,"admin":false,"staff":false,"user_id":430,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"via_email":true,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29376,"name":"Merlijn Sebrechts","username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png","created_at":"2018-07-06T06:08:34.183Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"kenvandine\" data-post=\"8\" data-topic=\"6235\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/kenvandine/40/4387_2.png\" class=\"avatar\"\u003e kenvandine:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThis is because the mount fails when the directory already exists. For an example see:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eThis doesn’t seem to be the case when I test it. When I use \u003ccode\u003esnap run --shell mattermost-desktop\u003c/code\u003e to look into those directories, I see the mounted ones, not the original ones. It seems to work just like a normal mount, hiding the original directory.\u003c/p\u003e","post_number":9,"post_type":1,"updated_at":"2018-07-06T06:08:34.183Z","reply_count":0,"reply_to_post_number":8,"quote_count":1,"incoming_link_count":7,"reads":92,"readers_count":91,"score":53.4,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Merlijn Sebrechts","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1418,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29382,"name":"James Henstridge","username":"jamesh","avatar_template":"/user_avatar/forum.snapcraft.io/jamesh/{size}/3947_2.png","created_at":"2018-07-06T07:53:20.058Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"sil\" data-post=\"2\" data-topic=\"6235\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/sil/40/182_2.png\" class=\"avatar\"\u003e sil:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThis looks like cool stuff. A question: you say “this can be achieved by adding the following boilerplate to the plugs: stanza of the project”, but surely this should be in there by default?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eThat is where we want to get to eventually, but don’t have the infrastructure in place yet.  I mentioned the upcoming Snapcraft Templates feature a little further down in that section as a solution, which will allow the required interface definitions to be inserted automatically.\u003c/p\u003e\n\u003cp\u003eWhile that feature isn’t quite ready yet, I thought there was value in sharing details of how people can test our what we’ve got working right now.\u003c/p\u003e\n\u003caside class=\"quote no-group\" data-username=\"galgalesh\" data-post=\"3\" data-topic=\"6235\" data-full=\"true\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/galgalesh/40/5329_2.png\" class=\"avatar\"\u003e galgalesh:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThis doesn’t seem to be working with Mattermost. However, when I run \u003ccode\u003esnap run --shell mattermost-desktop\u003c/code\u003e , I see the themes are mounted correctly in \u003ccode\u003eshare/*\u003c/code\u003e .\u003c/p\u003e\n\u003cp\u003eJust to clarify; does this also work with GTK2 applications or only GTK3 applications?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eAt the moment this is just GTK 3.  GTK 2 is more complicated due to the use of native code theme engines that need to match the GTK 2 build the application is using.\u003c/p\u003e\n\u003cp\u003eWhile you managed to get Communitheme working by packaging the pixbuf engine with your app, that wouldn’t be sufficient for e.g. Ubuntu’s Ambiance/Radiance themes that use the murrine engine.\u003c/p\u003e\n\u003cp\u003eWe will probably look at dealing with GTK 2 themes in future (together with packaging the binary engines), but having third parties packaging their themes will likely require more review due to the fact that the theme engines can effectively do anything.\u003c/p\u003e\n\u003cp\u003eFor Electron apps, it is worth considering moving forward to an Electron build that uses GTK 3, since that will be required for other upcoming desktop related features anyway.\u003c/p\u003e","post_number":10,"post_type":1,"updated_at":"2018-07-06T07:53:20.058Z","reply_count":2,"reply_to_post_number":2,"quote_count":2,"incoming_link_count":8,"reads":89,"readers_count":88,"score":82.8,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"James Henstridge","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":393,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29399,"name":"Stuart Langridge","username":"sil","avatar_template":"/user_avatar/forum.snapcraft.io/sil/{size}/182_2.png","created_at":"2018-07-06T11:42:23.941Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"jamesh\" data-post=\"10\" data-topic=\"6235\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/jamesh/40/3947_2.png\" class=\"avatar\"\u003e jamesh:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThat is where we want to get to eventually, but don’t have the infrastructure in place yet.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eAh, gotcha; that makes sense, and so this will just work later on. That will be good! Nice work.\u003c/p\u003e","post_number":11,"post_type":1,"updated_at":"2018-07-06T11:42:23.941Z","reply_count":0,"reply_to_post_number":10,"quote_count":1,"incoming_link_count":1,"reads":79,"readers_count":78,"score":20.8,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Stuart Langridge","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":764,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29464,"name":"Merlijn Sebrechts","username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png","created_at":"2018-07-06T23:46:53.653Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"jamesh\" data-post=\"10\" data-topic=\"6235\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/jamesh/40/3947_2.png\" class=\"avatar\"\u003e jamesh:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eI mentioned the upcoming Snapcraft Templates feature a little further down in that section as a solution, which will allow the required interface definitions to be inserted automatically.\u003c/p\u003e\n\u003cp\u003eWhile that feature isn’t quite ready yet, I thought there was value in sharing details of how people can test our what we’ve got working right now.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eSnapcraft Templates seems like a good way to go. In the meantime, can we add this support to the desktop helpers? It already has some support for themes, but using gtk-common-themes would make that more robust, support more themes and use less space.\u003c/p\u003e\n\u003cp\u003eCommunitheme is gaining a lot of traction but isn’t supported by default by desktop-helpers, so many snaps look ugly and some are even broken. Including \u003ccode\u003egtk-common-themes\u003c/code\u003e support in desktop-helpers will probably be the easiest way to fix as many snaps as soon as possible.\u003c/p\u003e\n\u003cp\u003e\u003ca class=\"mention\" href=\"/u/kenvandine\"\u003e@kenvandine\u003c/a\u003e \u003ca class=\"mention\" href=\"/u/didrocks\"\u003e@didrocks\u003c/a\u003e, what do you think?\u003c/p\u003e","post_number":12,"post_type":1,"updated_at":"2018-07-06T23:48:23.681Z","reply_count":1,"reply_to_post_number":10,"quote_count":1,"incoming_link_count":3,"reads":77,"readers_count":76,"score":35.4,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Merlijn Sebrechts","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1418,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29465,"name":"Ken VanDine","username":"kenvandine","avatar_template":"/user_avatar/forum.snapcraft.io/kenvandine/{size}/4387_2.png","created_at":"2018-07-07T00:29:24.659Z","cooked":"\u003cp\u003eThat’s not something we can do directly in the desktop-helpers.  Each snap would need to be updated adding the yaml to connect the content interfaces.  I’ve updated all the snaps maintained by the desktop team and they all work fine with communitheme.  I just don’t have a way to update other people’s snaps and I don’t want to encourage too many people to add this boilerplate code in their yaml that will be harder to maintain in the future.  It’s fine if they want to, but I don’t want to push people to do that.\u003c/p\u003e","post_number":13,"post_type":1,"updated_at":"2018-07-07T00:29:24.659Z","reply_count":1,"reply_to_post_number":12,"quote_count":0,"incoming_link_count":2,"reads":68,"readers_count":67,"score":43.6,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Ken VanDine","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"policy-reviewers","title_is_group":false,"reply_to_user":{"username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":430,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29476,"name":"James Henstridge","username":"jamesh","avatar_template":"/user_avatar/forum.snapcraft.io/jamesh/{size}/3947_2.png","created_at":"2018-07-07T06:40:59.657Z","cooked":"\u003cp\u003eI think \u003ca class=\"mention\" href=\"/u/galgalesh\"\u003e@galgalesh\u003c/a\u003e is suggesting that \u003ccode\u003esnapcraft-desktop-helpers\u003c/code\u003e pull in Communitheme manually so it gets included into the application snap.\u003c/p\u003e\n\u003cp\u003eI’d personally prefer not to do that: the whole point of the theme snap work was to recognise that no matter how many themes we bundle with an application snap, it will never be enough. And each bundled theme adds to the package size for every app the user installs.  In contrast, with theme snaps we only transfer the theme data once, and can update the themes without requiring every application developer to rebuild their snaps.\u003c/p\u003e","post_number":14,"post_type":1,"updated_at":"2018-07-07T06:40:59.657Z","reply_count":1,"reply_to_post_number":13,"quote_count":0,"incoming_link_count":2,"reads":73,"readers_count":72,"score":59.6,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"James Henstridge","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"kenvandine","avatar_template":"/user_avatar/forum.snapcraft.io/kenvandine/{size}/4387_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":2}],"moderator":false,"admin":false,"staff":false,"user_id":393,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29797,"name":"Merlijn Sebrechts","username":"galgalesh","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png","created_at":"2018-07-12T13:03:10.495Z","cooked":"\u003cp\u003eI thought it would be possible to add the plugs to the desktop-helpers.\u003c/p\u003e\n\u003cp\u003eSince this isn’t possible, I still think desktop-helpers should pull the theme manually because communitheme will be included in Ubuntu 17.10. I’d like to do this as soon as possible so that most snaps support Communitheme when 17.10 lands.\u003c/p\u003e","post_number":15,"post_type":1,"updated_at":"2018-07-12T13:04:34.182Z","reply_count":1,"reply_to_post_number":14,"quote_count":0,"incoming_link_count":1,"reads":74,"readers_count":73,"score":24.8,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"Merlijn Sebrechts","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"jamesh","avatar_template":"/user_avatar/forum.snapcraft.io/jamesh/{size}/3947_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1418,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29849,"name":"","username":"frederik-f","avatar_template":"/user_avatar/forum.snapcraft.io/frederik-f/{size}/3651_2.png","created_at":"2018-07-13T08:30:22.474Z","cooked":"\u003cp\u003eTo add something “noobish” to this conversation full of knowledge:\u003cbr\u003e\nIf gtk2 theming turns out to be really, absolutely impossible for snaps, there is one last thing that could be done as a backup plan b:\u003cbr\u003e\nIf it’s a Qt snap using the gtk2 theme via QGtkStyle then better use the native Qt skin then no skin. An example for this worst case is simplescreenrecorder which has no theme at all and ends up with no theme at all (grey).\u003c/p\u003e","post_number":16,"post_type":1,"updated_at":"2018-07-13T08:30:22.474Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":3,"reads":78,"readers_count":77,"score":35.6,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1890,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":29938,"name":"James Henstridge","username":"jamesh","avatar_template":"/user_avatar/forum.snapcraft.io/jamesh/{size}/3947_2.png","created_at":"2018-07-16T03:56:10.417Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"galgalesh\" data-post=\"15\" data-topic=\"6235\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/galgalesh/40/5329_2.png\" class=\"avatar\"\u003e galgalesh:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSince this isn’t possible, I still think desktop-helpers should pull the theme manually because communitheme will be included in Ubuntu 17.10. I’d like to do this as soon as possible so that most snaps support Communitheme when 17.10 lands.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eNote that what I’ve documented in this thread is the primary system we want to use for making themes available to snap applications going forward: it isn’t a fallback for those not using Ubuntu.\u003c/p\u003e\n\u003cp\u003eUpdating desktop-helpers would also require all application developers to rebuild their snaps, so isn’t obviously better.  And with themes like Communitheme that are still under active development, it wouldn’t just be a single rebuild (compare with the content interface solution, where pushing out a new gtk-common-themes release updates all applications).\u003c/p\u003e\n\u003cp\u003eI agree that the currently required boilerplate is undesirable, which is why the Snapcraft developers are working on the new templates feature.\u003c/p\u003e\n\u003caside class=\"quote no-group\" data-username=\"frederik-f\" data-post=\"16\" data-topic=\"6235\" data-full=\"true\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/frederik-f/40/3651_2.png\" class=\"avatar\"\u003e frederik-f:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eTo add something “noobish” to this conversation full of knowledge:\u003cbr\u003e\nIf gtk2 theming turns out to be really, absolutely impossible for snaps, there is one last thing that could be done as a backup plan b:\u003cbr\u003e\nIf it’s a Qt snap using the gtk2 theme via QGtkStyle then better use the native Qt skin then no skin. An example for this worst case is simplescreenrecorder which has no theme at all and ends up with no theme at all (grey).\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eI don’t think handling GTK 2 themes would be impossible: they just have vastly different security considerations compared to GTK 3 themes (e.g. how do you know that a GTK 2 theme engine doesn’t embed a Bitcoin miner?).\u003c/p\u003e\n\u003cp\u003eAs for Qt applications, any Qt 5 app should be able to use GTK 3 themes via the \u003ccode\u003eqgtk3\u003c/code\u003e platform theme plugin.  However, the \u003ccode\u003esimplescreenrecorder\u003c/code\u003e snap appears to have been built with Qt 4.  \u003ca href=\"https://github.com/MaartenBaert/ssr\" rel=\"noopener nofollow ugc\"\u003eLooking upstream\u003c/a\u003e it seems the application supports Qt 5, so rebuilding the snap would probably be the best option.\u003c/p\u003e","post_number":17,"post_type":1,"updated_at":"2018-07-16T03:56:10.417Z","reply_count":0,"reply_to_post_number":15,"quote_count":2,"incoming_link_count":61,"reads":82,"readers_count":81,"score":306.4,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"James Henstridge","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/MaartenBaert/ssr","internal":false,"reflection":false,"title":"GitHub - MaartenBaert/ssr: SimpleScreenRecorder, a screen recorder for Linux","clicks":1}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":393,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":33180,"name":"林博仁(Buo-ren, Lin)","username":"Lin-Buo-Ren","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png","created_at":"2018-09-07T08:51:30.827Z","cooked":"\u003caside class=\"quote no-group quote-modified\" data-username=\"jamesh\" data-post=\"1\" data-topic=\"6235\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/jamesh/40/3947_2.png\" class=\"avatar\"\u003e jamesh:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAllowing GTK to find the theme data\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eThis shouldn’t be necessary now as \u003ccode\u003e$SNAP/share\u003c/code\u003e should be already prepended in \u003ccode\u003eXDG_DATA_DIRS\u003c/code\u003e since \u003ca href=\"https://github.com/ubuntu/snapcraft-desktop-helpers/pull/121\"\u003ehttps://github.com/ubuntu/snapcraft-desktop-helpers/pull/121\u003c/a\u003e\u003c/p\u003e","post_number":18,"post_type":1,"updated_at":"2018-09-07T08:51:30.827Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":9,"reads":67,"readers_count":66,"score":58.4,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"林博仁(Buo-ren, Lin)","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/ubuntu/snapcraft-desktop-helpers/pull/121","internal":false,"reflection":false,"clicks":30}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1417,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":33913,"name":"James Henstridge","username":"jamesh","avatar_template":"/user_avatar/forum.snapcraft.io/jamesh/{size}/3947_2.png","created_at":"2018-09-17T08:34:09.519Z","cooked":"\u003cp\u003eIt looks like there are some problems with picking the correct theme under Wayland.\u003c/p\u003e\n\u003cp\u003eUnder Wayland, GTK selects its theme via the GSettings API.  While the \u003ccode\u003egsettings\u003c/code\u003e interface can give a snapped application access to the user’s configuration database (\u003ccode\u003e~/.config/dconf/user\u003c/code\u003e), it will be using a different set of GSettings schemas which can have different default values.\u003c/p\u003e\n\u003cp\u003eSo on my laptop running Cosmic, I see the following:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ gsettings get org.gnome.desktop.interface gtk-theme\n'Yaru'\n$ snap run --shell gnome-calculator\nTo run a command as administrator (user \"root\"), use \"sudo \u0026lt;command\u0026gt;\".\nSee \"man sudo_root\" for details.\n\n$ $SNAP/bin/desktop-launch gsettings get org.gnome.desktop.interface gtk-theme\n'Ambiance'\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e… and sure enough, gnome-calculator displays using the Ambiance theme while everything else is using Yaru.  This is not something that can be solved from within the snap, so we’ll probably need some extra support snapd side.\u003c/p\u003e","post_number":19,"post_type":1,"updated_at":"2018-09-17T08:34:09.519Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":67,"readers_count":66,"score":33.4,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"James Henstridge","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":393,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":35811,"name":"林博仁(Buo-ren, Lin)","username":"Lin-Buo-Ren","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png","created_at":"2018-10-14T13:09:07.602Z","cooked":"\u003caside class=\"quote no-group quote-modified\" data-username=\"jamesh\" data-post=\"1\" data-topic=\"6235\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://forum.snapcraft.io/user_avatar/forum.snapcraft.io/jamesh/40/3947_2.png\" class=\"avatar\"\u003e jamesh:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003ch2\u003eAllowing GTK to find the theme data\u003c/h2\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eIf you don’t mind I would like to drop this section as the environment is already handled by the \u003ccode\u003edesktop-launch\u003c/code\u003e script as I previously mentioned.\u003c/p\u003e","post_number":20,"post_type":1,"updated_at":"2018-10-14T13:09:17.495Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":10,"reads":62,"readers_count":61,"score":62.4,"yours":false,"topic_id":6235,"topic_slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","display_username":"林博仁(Buo-ren, Lin)","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1417,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[29242,29267,29354,29360,29362,29365,29368,29370,29376,29382,29399,29464,29465,29476,29797,29849,29938,33180,33913,35811,35835,45316,45437,54399,54432,54433,73580,73841]},"timeline_lookup":[[1,1808],[2,1807],[3,1806],[12,1805],[15,1800],[16,1799],[17,1796],[18,1743],[19,1733],[20,1706],[21,1705],[22,1547],[23,1544],[24,1384],[25,1383],[27,1085],[28,1080]],"tags":[],"id":6235,"title":"How to use the system GTK theme via the gtk-common-themes snap","fancy_title":"How to use the system GTK theme via the gtk-common-themes snap","posts_count":28,"created_at":"2018-07-04T09:23:15.238Z","views":19846,"reply_count":14,"like_count":27,"last_posted_at":"2020-06-30T19:50:13.733Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"how-to-use-the-system-gtk-theme-via-the-gtk-common-themes-snap","category_id":15,"word_count":2961,"deleted_at":null,"user_id":393,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_6235","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":28,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"topic_timer":null,"message_bus_last_id":0,"participant_count":10,"show_read_indicator":false,"thumbnails":null,"details":{"notification_level":1,"participants":[{"id":1418,"username":"galgalesh","name":"Merlijn Sebrechts","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png","post_count":8,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":393,"username":"jamesh","name":"James Henstridge","avatar_template":"/user_avatar/forum.snapcraft.io/jamesh/{size}/3947_2.png","post_count":6,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1417,"username":"Lin-Buo-Ren","name":"林博仁(Buo-ren, Lin)","avatar_template":"/user_avatar/forum.snapcraft.io/lin-buo-ren/{size}/4612_2.png","post_count":4,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":430,"username":"kenvandine","name":"Ken VanDine","avatar_template":"/user_avatar/forum.snapcraft.io/kenvandine/{size}/4387_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":764,"username":"sil","name":"Stuart Langridge","avatar_template":"/user_avatar/forum.snapcraft.io/sil/{size}/182_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":949,"username":"keshavnrj","name":"keshavnrj","avatar_template":"/user_avatar/forum.snapcraft.io/keshavnrj/{size}/5474_2.png","post_count":2,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":6174,"username":"knocte","name":"Andres G. Aragoneses","avatar_template":"/user_avatar/forum.snapcraft.io/knocte/{size}/5387_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":1890,"username":"frederik-f","name":"","avatar_template":"/user_avatar/forum.snapcraft.io/frederik-f/{size}/3651_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null},{"id":286,"username":"lucyllewy","name":"Lucy Llewellyn","avatar_template":"/user_avatar/forum.snapcraft.io/lucyllewy/{size}/9782_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null}],"created_by":{"id":393,"username":"jamesh","name":"James Henstridge","avatar_template":"/user_avatar/forum.snapcraft.io/jamesh/{size}/3947_2.png"},"last_poster":{"id":1418,"username":"galgalesh","name":"Merlijn Sebrechts","avatar_template":"/user_avatar/forum.snapcraft.io/galgalesh/{size}/9283_2.png"},"links":[{"url":"https://github.com/snapcrafters/gtk-common-themes","title":"GitHub - snapcrafters/gtk-common-themes","internal":false,"attachment":false,"reflection":false,"clicks":360,"user_id":393,"domain":"github.com","root_domain":"github.com"},{"url":"https://gist.github.com/jhenstridge/7f8c6d43bf21a42579e18d339be7a4fb","title":"Using the gtk-common-themes snap · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":332,"user_id":393,"domain":"gist.github.com","root_domain":"github.com"},{"url":"https://forum.snapcraft.io/t/use-the-system-gtk-theme/496","title":"Use the system gtk theme","internal":true,"attachment":false,"reflection":false,"clicks":187,"user_id":393,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/Lin-Buo-Ren/demo-gtk-common-themes","title":"GitHub - Lin-Buo-Ren/demo-gtk-common-themes: A demonstration application featuring the gtk-common-themes content snap","internal":false,"attachment":false,"reflection":false,"clicks":76,"user_id":1417,"domain":"github.com","root_domain":"github.com"},{"url":"https://specifications.freedesktop.org/xsettings-spec/xsettings-latest.html","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":67,"user_id":393,"domain":"specifications.freedesktop.org","root_domain":"freedesktop.org"},{"url":"https://snapcraft.io/docs/gtk2-applications","title":"GTK2 Applications | Snapcraft documentation","internal":false,"attachment":false,"reflection":false,"clicks":48,"user_id":1418,"domain":"snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/ubuntu/snapcraft-desktop-helpers/","title":"GitHub - ubuntu/snapcraft-desktop-helpers: Various launchers for snapcraft wiki parts","internal":false,"attachment":false,"reflection":false,"clicks":47,"user_id":1418,"domain":"github.com","root_domain":"github.com"},{"url":"https://forum.snapcraft.io/t/proposal-templates/6019","title":"Proposal: templates","internal":true,"attachment":false,"reflection":false,"clicks":43,"user_id":393,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/snapcrafters/mattermost-desktop/blob/master/snap/snapcraft.yaml","title":"mattermost-desktop/snapcraft.yaml at master · snapcrafters/mattermost-desktop · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":34,"user_id":1418,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/ubuntu/snapcraft-desktop-helpers/pull/121","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":30,"user_id":1417,"domain":"github.com","root_domain":"github.com"},{"url":"https://bazaar.launchpad.net/~ubuntu-desktop/quadrapassel/snap/view/head:/snapcraft.yaml#L26","title":"~ubuntu-desktop/quadrapassel/snap : contents of snapcraft.yaml at revision 23","internal":false,"attachment":false,"reflection":false,"clicks":27,"user_id":430,"domain":"bazaar.launchpad.net","root_domain":"launchpad.net"},{"url":"https://forum.snapcraft.io/t/use-the-system-gtk-theme/496/47","title":"Use the system gtk theme","internal":true,"attachment":false,"reflection":true,"clicks":21,"user_id":430,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/qt-apps-and-gtk-themes-an-investigation-with-partial-success/10513/4","title":"Qt Apps and GTK Themes, an investigation with partial success","internal":true,"attachment":false,"reflection":true,"clicks":12,"user_id":1417,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/gtk3-app-python-theme-and-font-support/9129/2","title":"Gtk3 App Python theme and font support","internal":true,"attachment":false,"reflection":true,"clicks":9,"user_id":1417,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/ubuntu/gtk-communitheme/issues/354#issuecomment-401633857","title":"None of the default provided snaps in 18.04 work properly with the snap community theme · Issue #354 · ubuntu/gtk-communitheme · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":6,"user_id":1418,"domain":"github.com","root_domain":"github.com"},{"url":"https://forum.snapcraft.io/t/supporting-desktop-themes-via-the-content-interface/4122/11","title":"Supporting desktop themes via the content interface","internal":true,"attachment":false,"reflection":true,"clicks":5,"user_id":393,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/auto-connect-doesnt-seem-to-work-on-refresh/6198","title":"Auto-connect doesn't seem to work on refresh","internal":true,"attachment":false,"reflection":false,"clicks":1,"user_id":1418,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://github.com/MaartenBaert/ssr","title":"GitHub - MaartenBaert/ssr: SimpleScreenRecorder, a screen recorder for Linux","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":393,"domain":"github.com","root_domain":"github.com"},{"url":"https://forum.snapcraft.io/t/reducing-the-size-of-desktop-snaps/17280","title":"Reducing the size of desktop snaps","internal":true,"attachment":false,"reflection":true,"clicks":1,"user_id":1418,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"}]}}