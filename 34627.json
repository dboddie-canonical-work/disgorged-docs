{"post_stream":{"posts":[{"id":122061,"name":"David Boddie","username":"dboddie","avatar_template":"/user_avatar/forum.snapcraft.io/dboddie/{size}/9564_2.png","created_at":"2023-04-05T15:45:11.267Z","cooked":"\u003cp\u003eSome snaps need to have access to system resources outside the scope allowed by strict confinement, and are unable to do this via the available interfaces. These snaps are configured to use classic confinement and will \u003ca href=\"/t/process-for-reviewing-classic-confinement-snaps/1460\"\u003eneed to be reviewed\u003c/a\u003e before publication in the Snap Store.\u003c/p\u003e\n\u003cp\u003eThis guide shows how to enable classic confinement for a snap built with the CMake plugin. The example project used in this guide can be found in \u003ca href=\"https://github.com/snapcraft-docs/cmake-classic-example\"\u003ethis repository\u003c/a\u003e.\u003c/p\u003e\n\u003ch2\u003eChange the confinement to classic\u003c/h2\u003e\n\u003cp\u003eStarting with an existing snapcraft.yaml file, change the \u003ccode\u003econfinement\u003c/code\u003e setting to \u003ccode\u003eclassic\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-yaml\"\u003econfinement: classic\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis will cause the snap to be built in a way that gives it access to system resources.\u003c/p\u003e\n\u003ch2\u003eUse linters to identify problems\u003c/h2\u003e\n\u003cp\u003eSnapcraft uses \u003ca href=\"/t/snapcraft-linters\"\u003elinters\u003c/a\u003e to check for issues during builds.\nLinters can only be specified in snaps that use the \u003ca href=\"/t/base-snaps\"\u003ecore22 base\u003c/a\u003e. Warnings are still reported for snaps that use older bases.\u003c/p\u003e\n\u003cp\u003eRun Snapcraft to build the snap. This may produce warnings like the following:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eLint warnings:                                                                                                                                \n- classic: usr/bin/cmake-example: ELF interpreter should be set to '/snap/core22/current/lib64/ld-linux-x86-64.so.2'. (https://snapcraft.io/docs/linters-classic)                                                                                                                            \n- classic: usr/bin/cmake-example: ELF rpath should be set to '/snap/core22/current/lib/x86_64-linux-gnu'. (https://snapcraft.io/docs/linters-classic)                                                                                                                                        \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf there are many warnings about libraries you can disable the library linter so that only classic linter warnings are shown. See the \u003ca href=\"/t/snapcraft-linters\"\u003elinters\u003c/a\u003e documentation for details.\u003c/p\u003e\n\u003ch2\u003eFix linter warnings by patching ELF binaries\u003c/h2\u003e\n\u003cp\u003eThe easiest way to handle warnings about the ELF interpreter and rpath is to let Snapcraft automatically patch the binaries using \u003ccode\u003epatchelf\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThis is enabled by default for \u003ccode\u003ecore20\u003c/code\u003e classic snaps, and can also be enabled for \u003ccode\u003ecore22\u003c/code\u003e classic snaps if you are using Snapcraft 7.3 or a version from the edge channel. Pass the \u003ccode\u003eenable-patchelf\u003c/code\u003e build attribute to the plugin:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-yaml\"\u003e    plugin: cmake\n    build-attributes:\n     - enable-patchelf\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis can be removed when automatic patching is enabled for \u003ccode\u003ecore22\u003c/code\u003e classic snaps in stable releases.\u003c/p\u003e\n\u003ch2\u003eRebuild the snap\u003c/h2\u003e\n\u003cp\u003eRun Snapcraft again to rebuild the snap, consulting the \u003ca href=\"/t/classic-linter\"\u003eClassic linter\u003c/a\u003e documentation to resolve further issues.\u003c/p\u003e\n\u003cp\u003eSee also \u003ca href=\"https://snapcraft.io/blog/the-new-classic-confinement-in-snaps-even-the-classics-need-a-change\"\u003ethis article \u003c/a\u003e for an overview of the classic linter and a discussion of the issues involved in building snaps for classic confinement.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2023-04-05T15:46:44.788Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":23,"reads":8,"readers_count":7,"score":106.6,"yours":false,"topic_id":34627,"topic_slug":"set-up-classic-confinement-for-a-cmake-project","display_username":"David Boddie","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://forum.snapcraft.io/t/base-snaps/11198","internal":true,"reflection":false,"title":"Base snaps","clicks":0},{"url":"https://snapcraft.io/blog/the-new-classic-confinement-in-snaps-even-the-classics-need-a-change","internal":false,"reflection":false,"title":"The new classic confinement in snaps â€“ Even the classics need a change | Snapcraft","clicks":0},{"url":"https://forum.snapcraft.io/t/classic-linter/32228","internal":true,"reflection":false,"title":"Classic linter","clicks":0},{"url":"https://forum.snapcraft.io/t/process-for-reviewing-classic-confinement-snaps/1460","internal":true,"reflection":false,"title":"Process for reviewing classic confinement snaps","clicks":0},{"url":"https://forum.snapcraft.io/t/snapcraft-linters/32211","internal":true,"reflection":false,"title":"Snapcraft linters","clicks":0},{"url":"https://github.com/snapcraft-docs/cmake-classic-example","internal":false,"reflection":false,"clicks":0},{"url":"https://forum.snapcraft.io/t/how-to-guides-for-classic-confinement/34416","internal":true,"reflection":true,"title":"How to guides for classic confinement","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":14015,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[122061]},"timeline_lookup":[[1,71]],"suggested_topics":[{"id":31049,"title":"Snapcraft How-to guides","fancy_title":"Snapcraft How-to guides","slug":"snapcraft-how-to-guides","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-07-27T10:34:11.548Z","last_posted_at":"2022-07-27T10:34:11.663Z","bumped":true,"bumped_at":"2023-04-05T08:45:13.573Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":1201,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":30905,"title":"Snapcraft documentation","fancy_title":"Snapcraft documentation","slug":"snapcraft-documentation","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-07-15T11:05:45.374Z","last_posted_at":"2022-07-15T11:05:45.528Z","bumped":true,"bumped_at":"2023-02-17T19:55:21.024Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":1532,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":35613,"title":"Revisions","fancy_title":"Revisions","slug":"revisions","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2023-06-14T12:00:32.246Z","last_posted_at":"2023-06-14T12:00:32.397Z","bumped":true,"bumped_at":"2023-06-15T11:10:36.858Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":45,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":33076,"title":"Intermediate snapcraft.yaml example","fancy_title":"Intermediate snapcraft.yaml example","slug":"intermediate-snapcraft-yaml-example","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2022-12-13T12:33:36.674Z","last_posted_at":"2022-12-15T10:46:41.984Z","bumped":true,"bumped_at":"2022-12-13T12:33:36.830Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":814,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":33078,"title":"Build and publishing example","fancy_title":"Build and publishing example","slug":"build-and-publishing-example","posts_count":5,"reply_count":1,"highest_post_number":5,"image_url":null,"created_at":"2022-12-13T13:17:46.677Z","last_posted_at":"2023-05-31T16:11:13.715Z","bumped":true,"bumped_at":"2023-05-31T16:11:13.715Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":1,"views":729,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":14652,"username":"jh-slack","name":"Jade Ho","avatar_template":"/letter_avatar/jh-slack/{size}/5_6d6f4cde2641c35611d5cac2fb97c77e.png"}}]}],"tags":["how-to"],"id":34627,"title":"Set up classic confinement for a CMake project","fancy_title":"Set up classic confinement for a CMake project","posts_count":1,"created_at":"2023-04-05T15:45:11.140Z","views":186,"reply_count":0,"like_count":0,"last_posted_at":"2023-04-05T15:45:11.267Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"set-up-classic-confinement-for-a-cmake-project","category_id":15,"word_count":423,"deleted_at":null,"user_id":14015,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_34627","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":1,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"topic_timer":null,"message_bus_last_id":0,"participant_count":1,"show_read_indicator":false,"thumbnails":null,"details":{"notification_level":1,"participants":[{"id":14015,"username":"dboddie","name":"David Boddie","avatar_template":"/user_avatar/forum.snapcraft.io/dboddie/{size}/9564_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null}],"created_by":{"id":14015,"username":"dboddie","name":"David Boddie","avatar_template":"/user_avatar/forum.snapcraft.io/dboddie/{size}/9564_2.png"},"last_poster":{"id":14015,"username":"dboddie","name":"David Boddie","avatar_template":"/user_avatar/forum.snapcraft.io/dboddie/{size}/9564_2.png"}}}