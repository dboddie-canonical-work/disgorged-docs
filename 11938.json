{"post_stream":{"posts":[{"id":50481,"name":"Graham Morrison","username":"degville","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","created_at":"2019-06-21T17:07:30.167Z","cooked":"\u003cp\u003eWhen creating \u003ca href=\"/t/creating-snapcraft-yaml/11666\"\u003esnapcraft.yaml\u003c/a\u003e and building a new snap, it’s not uncommon to encounter build issues when running \u003cem\u003esnapcraft\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eFor this reason, it can be helpful to build the snap early, even before adding interfaces. It makes finding the culprit easier, and stops early issues affecting later stages of the build, complicating any debugging that needs to be done.\u003c/p\u003e\n\u003ch2\u003eIterating over a build\u003c/h2\u003e\n\u003cp\u003eWhen building a snap, run \u003ccode\u003esnapcraft --debug\u003c/code\u003e rather than \u003ccode\u003esnapcraft\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eWith \u003ccode\u003e--debug\u003c/code\u003e, if snapcraft encounters an error it will open a shell  within the virtualised build environment that snapcraft instantiates by default.\u003c/p\u003e\n\u003cp\u003eThis enables you to view logs within the environment, check the value of environment variables, locate missing binaries and install missing dependencies. You can even edit \u003cem\u003esnapcraft.yaml\u003c/em\u003e outside of the shell, and then run \u003cem\u003esnapcraft\u003c/em\u003e within, to continue the build.\u003c/p\u003e\n\u003cp\u003eBuild issues are linked to the stage that \u003cem\u003esnapcraft\u003c/em\u003e is working through (see \u003ca href=\"/t/parts-lifecycle/12231\"\u003eSnapcraft lifecycle\u003c/a\u003e) when it generates an error, and the most common problems associated with each step are outlined below.\u003c/p\u003e\n\u003ch3\u003e\u003cstrong\u003e1. Snapcraft.yaml\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003eThese errors typically occur early, before any processing, and they’re usually easy to resolve.\u003c/p\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eIssues while validating snapcraft.yaml: 'adopt-info' is a required \nproperty or 'version' is a required property:\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe above issue is caused by a mandatory keyword, \u003ccode\u003eversion\u003c/code\u003e, not being defined.\u003c/p\u003e\n\u003cp\u003eHowever, \u003ccode\u003eversion\u003c/code\u003e isn’t actually mandatory when paired with \u003ccode\u003eadopt-info\u003c/code\u003e, because \u003ccode\u003eadopt-info\u003c/code\u003e  pushes version details into snapcraft from its specified part. This isn’t processed until later in the build, which means any error in \u003ccode\u003eadopt-info\u003c/code\u003e isn’t generated until the ‘prime’ phase:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eFailed to generate snap metadata: 'adopt-info' refers to part 'mypart',\nbut that part is lacking the 'parse-info' property. \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo resolve this, make sure your part includes \u003ccode\u003eparse-info\u003c/code\u003e or runs a command to define the version details (such as \u003ccode\u003esnapcraftctl set-version\u003c/code\u003e).\u003c/p\u003e\n\u003cp\u003eFor more information on the keywords most affected by this error, see \u003ca href=\"/t/adding-global-metadata/11486\"\u003eAdding global metadata\u003c/a\u003e.\u003c/p\u003e\n\u003ch3\u003e2. Build phase\u003c/h3\u003e\n\u003cp\u003eErrors in this phase are only generated by projects building their own binaries from source code.\u003c/p\u003e\n\u003cp\u003eAny issues that do occur are likely to be similar to those associated with compiling the project  outside of snapcraft, and it can help to first build manually, or be familiar with the part that’s failing to build, before updating your snap.\u003c/p\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ePackage ncursesw was not found in the pkg-config search path.\nPerhaps you should add the directory containing `ncursesw.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'ncursesw' found\npkg-config: exit status 1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe above example is easily rectified by adding \u003ccode\u003elibncursesw5-dev\u003c/code\u003e under \u003cem\u003ebuild-packages\u003c/em\u003e for the part that’s failing to build, as you would need to building outside of snapcraft.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-yaml\"\u003ebuild-packages:\n   - libncursesw5-dev\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFor more details on package names and build dependencies, see \u003ca href=\"/t/build-and-staging-dependencies/11451\"\u003eBuild and staging dependencies\u003c/a\u003e.\u003c/p\u003e\n\u003ch3\u003e3. Staging phase\u003c/h3\u003e\n\u003cp\u003eErrors in this phase are synonymous with missing dependencies in any run-time environment.\u003c/p\u003e\n\u003cp\u003eMissing elements are typically libraries, and sometimes binaries, that an application needs to run correctly. Errors manifest at run-time, or when a library should be accessed, and those errors are generated by the application rather than the snap.\u003c/p\u003e\n\u003cp\u003eA git client, for example, might not use the \u003cem\u003egit\u003c/em\u003e command directly until it needs to. Only then will its absence become apparent (and only if \u003cem\u003egit\u003c/em\u003e isn’t installed on the host system).\u003c/p\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eUnable to successfully call git binary. If git is not in $PATH then please \nset the config variable git-binary-file-path   \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe solution is to add the packages for these missing dependencies under \u003cem\u003estage-packages\u003c/em\u003e within the affected part:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-yaml\"\u003estage-packages:\n- git\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAs with build dependencies, for more details on working out staging dependencies see \u003ca href=\"/t/build-and-staging-dependencies/11451\"\u003eBuild and staging dependencies\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eFor further tips on common build issues, see \u003ca href=\"/t/debugging-building-snaps/6274\"\u003eDebugging building snaps\u003c/a\u003e.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2020-04-03T10:36:03.306Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":149,"reads":23,"readers_count":22,"score":739.6,"yours":false,"topic_id":11938,"topic_slug":"troubleshoot-snap-building","display_username":"Graham Morrison","primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_bg_color":null,"primary_group_flair_color":null,"version":8,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://forum.snapcraft.io/t/debugging-building-snaps/6274","internal":true,"reflection":false,"title":"Debugging building snaps","clicks":9},{"url":"https://forum.snapcraft.io/t/build-and-staging-dependencies/11451","internal":true,"reflection":false,"title":"Build and staging dependencies","clicks":9},{"url":"https://forum.snapcraft.io/t/creating-snapcraft-yaml/11666","internal":true,"reflection":false,"title":"Creating snapcraft.yaml","clicks":4},{"url":"https://forum.snapcraft.io/t/adding-global-metadata/11486","internal":true,"reflection":false,"title":"Adding global metadata","clicks":4},{"url":"https://forum.snapcraft.io/t/parts-lifecycle/12231","internal":true,"reflection":false,"title":"Parts lifecycle","clicks":3},{"url":"https://forum.snapcraft.io/t/troubleshooting/20595","internal":true,"reflection":true,"title":"Troubleshooting","clicks":2},{"url":"https://forum.snapcraft.io/t/snapcraft-build-debug-and-publishing-docs-roadmap-page-breakdown/10366","internal":true,"reflection":true,"title":"Snapcraft build, debug and publishing docs roadmap (page breakdown)","clicks":1},{"url":"https://forum.snapcraft.io/t/snapcraft-explanation-guides/31050","internal":true,"reflection":true,"title":"Snapcraft Explanation guides","clicks":0},{"url":"https://forum.snapcraft.io/t/snap-documentation/11127","internal":true,"reflection":true,"title":"Snap documentation","clicks":0},{"url":"https://forum.snapcraft.io/t/iterating-over-a-build/12143","internal":true,"reflection":true,"title":"Iterating over a build","clicks":0},{"url":"https://forum.snapcraft.io/t/documentation-roadmap/8763","internal":true,"reflection":true,"title":"Documentation roadmap","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":true,"admin":true,"staff":true,"user_id":2772,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":true,"last_wiki_edit":"2020-04-03T10:36:03.333Z","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[50481]},"timeline_lookup":[[1,1455]],"suggested_topics":[{"id":32986,"title":"Snapcraft installation and setup","fancy_title":"Snapcraft installation and setup","slug":"snapcraft-installation-and-setup","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2022-12-07T12:49:10.746Z","last_posted_at":"2022-12-15T10:43:52.370Z","bumped":true,"bumped_at":"2022-12-07T12:49:10.898Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":819,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":31037,"title":"Snapcraft Tutorials","fancy_title":"Snapcraft Tutorials","slug":"snapcraft-tutorials","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-07-26T17:19:27.439Z","last_posted_at":"2022-07-26T17:19:27.549Z","bumped":true,"bumped_at":"2023-04-05T08:33:18.861Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":1214,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":32908,"title":"The pwm-control interface","fancy_title":"The pwm-control interface","slug":"the-pwm-control-interface","posts_count":8,"reply_count":6,"highest_post_number":9,"image_url":null,"created_at":"2022-11-30T08:57:34.695Z","last_posted_at":"2023-03-30T09:37:54.031Z","bumped":true,"bumped_at":"2023-03-30T09:37:54.031Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":3,"views":552,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":8707,"username":"zyga","name":"Zygmunt Krynicki","avatar_template":"/user_avatar/forum.snapcraft.io/zyga/{size}/4376_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":11710,"username":"rpjday","name":"Robert P. J. Day","avatar_template":"/user_avatar/forum.snapcraft.io/rpjday/{size}/8457_2.png"}}]},{"id":34740,"title":"Super-privileged interfaces","fancy_title":"Super-privileged interfaces","slug":"super-privileged-interfaces","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2023-04-14T09:20:24.510Z","last_posted_at":"2023-04-14T09:20:24.656Z","bumped":true,"bumped_at":"2023-04-14T09:29:53.927Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":260,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}}]},{"id":31051,"title":"Snapcraft Reference","fancy_title":"Snapcraft Reference","slug":"snapcraft-reference","posts_count":5,"reply_count":1,"highest_post_number":5,"image_url":null,"created_at":"2022-07-27T11:51:00.654Z","last_posted_at":"2023-04-24T17:52:24.772Z","bumped":true,"bumped_at":"2023-04-25T05:31:27.608Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags":[],"like_count":0,"views":1238,"category_id":15,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":14015,"username":"dboddie","name":"David Boddie","avatar_template":"/user_avatar/forum.snapcraft.io/dboddie/{size}/9564_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":11710,"username":"rpjday","name":"Robert P. J. Day","avatar_template":"/user_avatar/forum.snapcraft.io/rpjday/{size}/8457_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":2185,"username":"abitrolly","name":"Anatoli Babenia","avatar_template":"/user_avatar/forum.snapcraft.io/abitrolly/{size}/4528_2.png"}}]}],"tags":[],"id":11938,"title":"Troubleshoot snap building","fancy_title":"Troubleshoot snap building","posts_count":1,"created_at":"2019-06-21T17:07:29.924Z","views":4943,"reply_count":0,"like_count":0,"last_posted_at":"2019-06-21T17:07:30.167Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"troubleshoot-snap-building","category_id":15,"word_count":674,"deleted_at":null,"user_id":2772,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_11938","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":1,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"topic_timer":null,"message_bus_last_id":0,"participant_count":1,"show_read_indicator":false,"thumbnails":null,"details":{"notification_level":1,"participants":[{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png","post_count":1,"primary_group_name":null,"primary_group_flair_url":null,"primary_group_flair_color":null,"primary_group_flair_bg_color":null}],"created_by":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"},"last_poster":{"id":2772,"username":"degville","name":"Graham Morrison","avatar_template":"/user_avatar/forum.snapcraft.io/degville/{size}/2021_2.png"},"links":[{"url":"https://forum.snapcraft.io/t/debugging-building-snaps/6274","title":"Debugging building snaps","internal":true,"attachment":false,"reflection":false,"clicks":9,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/build-and-staging-dependencies/11451","title":"Build and staging dependencies","internal":true,"attachment":false,"reflection":false,"clicks":9,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/creating-snapcraft-yaml/11666","title":"Creating snapcraft.yaml","internal":true,"attachment":false,"reflection":false,"clicks":4,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/adding-global-metadata/11486","title":"Adding global metadata","internal":true,"attachment":false,"reflection":false,"clicks":4,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/parts-lifecycle/12231","title":"Parts lifecycle","internal":true,"attachment":false,"reflection":false,"clicks":3,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/troubleshooting/20595","title":"Troubleshooting","internal":true,"attachment":false,"reflection":true,"clicks":2,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"},{"url":"https://forum.snapcraft.io/t/snapcraft-build-debug-and-publishing-docs-roadmap-page-breakdown/10366","title":"Snapcraft build, debug and publishing docs roadmap (page breakdown)","internal":true,"attachment":false,"reflection":true,"clicks":1,"user_id":2772,"domain":"forum.snapcraft.io","root_domain":"snapcraft.io"}]}}